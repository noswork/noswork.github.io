const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/n3zqaiyl90r8ot1y.js","assets/pb09dh9fam0wt6jz.js","assets/bjx6p88nrzc4ug4u.js","assets/root-bozb8ycf.css","assets/8i5ljbfelmyfiwtx.js","assets/conversation-small-gdrsfoe1.css","assets/brh21o61fqsobput.js","assets/n52e1vlj3htmeq8c.js","assets/foaloc98fvuwqvvu.js","assets/md179rb61zx4u3z5.js"])))=>i.map(i=>d[i]);
var mi=Object.defineProperty,pi=Object.defineProperties;var fi=Object.getOwnPropertyDescriptors;var lo=Object.getOwnPropertySymbols;var gi=Object.prototype.hasOwnProperty,hi=Object.prototype.propertyIsEnumerable;var co=(s,e,n)=>e in s?mi(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,me=(s,e)=>{for(var n in e||(e={}))gi.call(e,n)&&co(s,n,e[n]);if(lo)for(var n of lo(e))hi.call(e,n)&&co(s,n,e[n]);return s},os=(s,e)=>pi(s,fi(e));import{d9 as ht,i as Pe,iy as Go,jo as xi,kv as Ho,y as mt,c3 as tn,bq as Ge,b as nn,a as bi,q as Ue,L as hs,p as xs,j as He,e as ye,P as _e,aQ as Ne,c8 as bs,z as We,gw as Si,H as Ns,kS as _i,jm as yi,jk as Ai,gx as xt,gs as Wo,aN as ve,B as Ci,ab as on,d_ as an,d$ as rn,X as Ds,Z as Fs,r9 as wi,a9 as ki,f5 as ji,x as Kt,fd as bt,aO as Ti,ae as ln,bp as pt,ra as Pi,cB as zo,ca as ut,bo as qo,cp as Ei,gf as Vo,f as cn,ed as le,gc as vs,ff as Mi,oj as vi,Q as $o,U as Jo,gj as ft,a3 as I,aU as $e,aB as Ri,aC as Yo,lb as Ko,pG as Bi,ee as Ni,rb as Di,rc as Fi,fM as Qo,gm as Se,kn as Oi,lQ as Li,rd as Qt,fn as gs,jb as Ii,jc as Ui,jd as Gi,jf as Hi,jj as Wi,re as zi,fv as Xo,rf as qi,rg as Vi,rh as nt,la as It,gU as $i,gu as Je,ri as Ji,df as Zo,T as un,bA as ea,rj as Yi,ba as Ki,rk as Qi,jr as dn,f9 as sa,aR as Xt,dV as Me,_ as ta,hP as Zt,ls as na,fb as mn,fe as oa,dN as Xi,fm as Zi,fg as pn,dT as uo,fj as aa,rl as el,rm as sl,mZ as tl,rn as nl,ro as ol,rp as al,kL as ra,dU as ia,rq as rl,lo as il,E as ll,rr as cl,rs as ul,rt as dl,o2 as ml,dQ as pl,aq as la,ru as fl,rv as ca,pd as ua,c1 as da,lF as ma,jF as en,lI as pa,rw as gl,lE as Ut,gt as hl,V as xl,fS as bl,g6 as Sl,rx as _l,az as yl,jA as Al,ry as Cl,Y as wl,l1 as kl,cI as jl,cj as Tl,bR as mo,mK as Pl,pa as El,rz as Ml,hO as vl,rA as Rl,fZ as Bl,fw as Nl,ga as po,l8 as Dl,b_ as Fl,is as Ol,ay as Ll,jB as Il,fN as Ul,fQ as Gl,cE as fo,gh as go,gb as Hl,oL as Wl,g9 as zl,rB as ql,oI as Vl,oJ as $l,aS as ot,aM as ho,fl as xo,go as at,nf as Jl,ko as Yl,oO as Kl,oM as Ql,oN as Xl,aF as Zl,qZ as ec,jp as Es,r as sc,fU as bo,lt as tc,rC as So,$ as Gt,a0 as Ht,aK as nc,rD as oc,cO as _o,lG as ac,rE as rc,gp as ic,rF as lc,jH as cc,rG as uc,j6 as yo,jE as Ao,rH as dc,eZ as mc,by as pc,rI as fc,rJ as gc,rK as hc,au as Co,cx as xc,f_ as bc,cJ as Sc}from"./bjx6p88nrzc4ug4u.js";import{b as Ie,r as g,j as t,M as ce,c as ts,d as St,g as is,A as _c,m as Os,i as yc}from"./pb09dh9fam0wt6jz.js";import{br as ss,ph as Ac,pi as Cc,nh as Wt,ew as fa,ao as ga,nJ as wc,bs as rs,pj as kc,pk as jc,a7 as Tc,pl as Ls,pm as ha,pn as Pc,ad as Ec,am as Mc,ns as vc,cY as Rc,po as Bc,ln as Nc,nW as xa,pp as wo,pq as Dc,pr as Fc,oh as Oc,kR as ba,ps as Sa,lo as ko,pt as Lc,pu as Ic,jf as _a,jg as Uc,pv as Gc,pw as Hc,n$ as De,o0 as Ss,px as j,py as Wc,pz as zc,aw as qc,pA as Vc,pB as ya,pC as $c,ok as Jc,pD as Yc,pE as jo,pF as Kc,pG as Qc,pH as Xc,pI as Zc,pJ as eu,pK as su,pL as tu,pM as nu,pN as ou,pO as au,pP as To,pQ as ru,pR as iu,pS as lu,pT as cu,pU as uu,pV as du,pW as mu,pX as pu,pY as fu,pZ as gu,p_ as hu,p$ as xu,q0 as bu,q1 as Su,jk as _u,q2 as yu,q3 as Au,q4 as Cu,q5 as wu,q6 as ku,q7 as ju,q8 as Tu,q9 as Pu,qa as Eu,qb as Mu,qc as vu,qd as Ru,qe as Bu,qf as Nu,qg as Du,qh as Fu,qi as Ou,qj as Lu,qk as Iu,ql as Uu,qm as Gu,es as Aa,qn as Ca,qo as Hu,nS as Wu,oi as zu,qp as qu,qq as Vu,qr as $u,cR as Ju,en as wa,nM as ka,bt as Yu,qs as Ku,qt as Po,qu as Qu,lv as ja,bY as Ta,qv as Pa,qw as Xu,qx as Zu,qy as ed,qz as Eo,gG as dt,qA as sd,qB as Ea,qC as Ma,qD as td,a3 as nd,qE as od,qF as ad,qG as rd,qH as id,fG as va,lB as ld,qI as Ra,c2 as Bs,i$ as cd,qJ as ud,nC as dd,qK as md,qL as pd,qM as fd,qN as Mo,eK as gd,bX as hd,bN as xd,qO as bd,co as Ba,qP as Na,qQ as Da,qR as Fa,qS as Sd,qT as Oa,qU as _d,qV as yd,qW as Ad,qX as Cd,qY as zt,qZ as wd,q_ as kd,q$ as jd,r0 as Td,r1 as qt,r2 as rt,r3 as Pd,r4 as Ed,r5 as vo,r6 as Md,r7 as vd,r8 as Rd,r9 as Bd,ra as Nd,P as Ro,rb as Dd,rc as Fd,gc as Od,rd as Ld,re as Id,rf as Ud,rg as Gd,rh as Hd,ri as Wd,rj as zd,rk as qd,cp as Vd,rl as $d,rm as Jd,gt as Yd,kW as Kd,rn as Qd,ro as Bo,gi as Ms,rp as No,mI as Xd,oo as Zd,rq as em,rr as sm,rs as tm,lC as Vt,rt as nm,ru as Do,rv as om,g3 as am,rw as rm,rx as im,kh as lm,ki as cm,kj as um,ry as dm,rz as mm,rA as pm,rB as fm,fD as Te,dJ as gm,rC as hm,rD as xm,rE as bm,er as Sm,rF as $t,rG as _m,ji as ym,rH as Am,eq as Cm,rI as wm,rJ as Fo,rK as km,rL as jm,rM as Jt,rN as Tm,rO as Pm,ep as Oo,rP as Em,rQ as Mm,rR as vm,rS as Rm,rT as Bm,rU as Nm,rV as Dm,rW as Fm,rX as Om,rY as Lm,rZ as Im,r_ as Um,r$ as Gm,s0 as Hm,s1 as Wm,s2 as zm,s3 as qm,s4 as Vm,s5 as $m,s6 as Jm,s7 as Ym,s8 as Km,s9 as Qm,sa as Xm,sb as Zm}from"./8i5ljbfelmyfiwtx.js";import{P as ep,u as sp,C as tp}from"./d0imfrhbhhd08mu9.js";import{u as np}from"./e8dm0mb6drcqj6ac.js";import{getTabScreenshot as op}from"./ns5tatduybx01g53.js";import{u as ap}from"./nzmrf34k5gq1uhrp.js";import{P as rp,u as ip,h as lp}from"./fs0qxa2k8rip3kxa.js";const gt="month",La="year";function cp(){const s=ht(),e=Pe(),n=Ie(),{markAsViewed:i}=ss(Ac),{initialBillingDetails:r}=np(s,!0),a=g.useMemo(()=>os(me({},s==null?void 0:s.subscriptionAnalyticsParams),{referrer:document.referrer}),[s]);async function c(){try{await wc(r,a)}catch(h){}}const{shouldShowBanner:o,discountValue:d,discountDuration:u}=Cc();if(g.useEffect(()=>{o&&d&&u&&Wt.logShowReferrerRedemptionBanner()},[o,d,u]),!o||!d||!u)return null;const m=up(n,r,d,u),b=dp(n,r,d,u),C=t.jsxs("div",{className:"grow",children:[t.jsx("div",{className:"mb-0.5 font-semibold",children:m}),t.jsx("span",{className:"text-token-text-secondary",children:b})]});return t.jsx(Go,{onPrimaryCtaClick:()=>{i(),Wt.logClickReferrerRedeemButton(),c()},primaryCtaText:t.jsx(ce,me({},xi(e))),onDismiss:()=>{i(),Wt.logCloseReferrerRedemptionBanner()},content:C})}function up(s,e,n,i){var m,b;const{currencySymbol:r}=fa(ga(),e.currency),a=i?i.period:gt,c=i?i.num_periods:1,o=(b=(m=r.code.defaultMessage)==null?void 0:m.toString())!=null?b:Ho,d=s.formatNumber(n.value,{style:"currency",currency:o,minimumFractionDigits:0,maximumFractionDigits:2});let u;return a===gt?u=c===1?t.jsx(ce,{id:"referrerRedemptionBannerTitleForSingleMonth",defaultMessage:"Your {discount} credit is ready",values:{discount:d}}):t.jsx(ce,{id:"referrerRedemptionBannerTitleForPluralMonths",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}}):a===La&&(u=c===1?t.jsx(ce,{id:"referrerRedemptionBannerTitleForSingleYear",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}}):t.jsx(ce,{id:"referrerRedemptionBannerTitleForPluralYears",defaultMessage:"Redeem your {discount} referral reward",values:{discount:d}})),u}function dp(s,e,n,i){var m,b;const{currencySymbol:r}=fa(ga(),e.currency),a=i?i.period:gt,c=i?i.num_periods:1,o=(b=(m=r.code.defaultMessage)==null?void 0:m.toString())!=null?b:Ho,d=s.formatNumber(n.value,{style:"currency",currency:o,minimumFractionDigits:0,maximumFractionDigits:2});let u;return a===gt?u=c===1?t.jsx(ce,{id:"referrerRedemptionBannerContentForSingleMonth",defaultMessage:"Your referral link was used â€” claim your free month of Plus."}):t.jsx(ce,{id:"referrerRedemptionBannerContentForPluralMonths",defaultMessage:"Your referral link earned you {discount} off {num_months} months of Plus.",values:{discount:d,num_months:c}}):a===La&&(u=c===1?t.jsx(ce,{id:"referrerRedemptionBannerContentForSingleYear",defaultMessage:"Your referral link earned you {discount} off a year of Plus.",values:{discount:d}}):t.jsx(ce,{id:"referrerRedemptionBannerContentForPluralYears",defaultMessage:"Your referral link earned you {discount} off {num_years} years of Plus.",values:{discount:d,num_years:c}})),u}const Lo=St({bannerBody:{id:"gqtTeH",defaultMessage:"Work smarter and better with coworkers in your organization"},dismissBanner:{id:"hbc/Bs",defaultMessage:"Dismiss banner"}});function mp(s){"use forget";const e=ts.c(13),{clientThreadId:n,canShowBanner:i}=s,r=i===void 0?!1:i,a=Pe();let c;e[0]!==a?(c=mt(a),e[0]=a,e[1]=c):c=e[1];const o=c;let d;e[2]!==n?(d=tn(n),e[2]=n,e[3]=d):d=e[3];const u=d,m=Ge(n,gp),{eligible:b}=ss(rs.hasSeenJoinWorkspaceBanner),C=u&&!m,h=nn(),x=(h==null?void 0:h.email_domain_type)==="professional",T=o&&x&&r&&C&&u&&!m&&b,{data:S,isLoading:B}=bi(),v=!!(S!=null&&S.accountItems.some(fp));let N;e[4]!==a?(N=Ue(a,"3217430380",{disableExposureLog:!0}).get("enable_workspace_discovery",!1),e[4]=a,e[5]=N):N=e[5];const P=!B&&!v&&N&&T,E=hs.getItem(xs.WorkspaceDiscoveryInfo),p=kc(E);let A;e[6]!==a?(A=He(a,"69563813"),e[6]=a,e[7]=A):A=e[7];const Y=!p&&A&&P,{data:q,isFetching:W}=jc(Y),F=q==null?void 0:q.workspaces.some(pp);if(!(!W&&(p||F)&&P)){let ae;return e[8]===Symbol.for("react.memo_cache_sentinel")?(ae={shouldShow:!1},e[8]=ae):ae=e[8],ae}let V;e[9]!==a?(V=Ue(a,"1200251816").get("enable-join-workspaces-banner",!1),e[9]=a,e[10]=V):V=e[10];const U=V;let se;return e[11]!==U?(se={shouldShow:U},e[11]=U,e[12]=se):se=e[12],se}function pp(s){return!s.requested}function fp(s){return s.isEnterprisey()}function gp(s){return Ne.hasUserMessage(s)}function Yf(){"use forget";const s=ts.c(22),e=Pe(),{markAsViewed:n}=ss(rs.hasSeenJoinWorkspaceBanner);let i;s[0]!==n?(i=()=>{_e.logEventWithStatsig("Thread Join Workspace Banner Button Dismissed","chatgpt_thread_join_workspace_banner_button_dismissed"),n()},s[0]=n,s[1]=i):i=s[1];const r=i;let a;s[2]===Symbol.for("react.memo_cache_sentinel")?(a=[],s[2]=a):a=s[2],g.useEffect(hp,a);let c;s[3]!==e||s[4]!==n?(c=()=>{_e.logEventWithStatsig("Thread Join Workspace Banner Button Clicked","chatgpt_thread_join_workspace_banner_button_clicked"),n(),bs(e,Tc,{mode:"dismissible",section:"both",source:"join_workspace_banner"})},s[3]=e,s[4]=n,s[5]=c):c=s[5];const o=c;let d;s[6]===Symbol.for("react.memo_cache_sentinel")?(d=ye("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden","pe-7"),s[6]=d):d=s[6];let u;s[7]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:t.jsx(Ls,{className:"icon-sm","aria-hidden":"true"})}),s[7]=u):u=s[7];let m,b;s[8]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsxs("span",{className:"flex items-center gap-1.5",children:[u,t.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:t.jsx(ce,me({},Lo.bannerBody))})]}),b=t.jsx("span",{className:ye("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:t.jsx("span",{children:t.jsx(ce,{id:"V/M/bo",defaultMessage:"Find Workspaces"})})}),s[8]=m,s[9]=b):(m=s[8],b=s[9]);let C;s[10]!==o?(C=t.jsxs("button",{type:"button",onClick:o,className:d,children:[m,b]}),s[10]=o,s[11]=C):C=s[11];let h;s[12]!==r?(h=N=>{N.stopPropagation(),r()},s[12]=r,s[13]=h):h=s[13];let x,T;s[14]===Symbol.for("react.memo_cache_sentinel")?(T=ye("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),x=t.jsx(ha,{className:"icon-xs","aria-hidden":"true"}),s[14]=x,s[15]=T):(x=s[14],T=s[15]);let S;s[16]===Symbol.for("react.memo_cache_sentinel")?(S=t.jsx("span",{className:"sr-only",children:t.jsx(ce,me({},Lo.dismissBanner))}),s[16]=S):S=s[16];let B;s[17]!==h?(B=t.jsxs("button",{type:"button",onClick:h,className:T,children:[x,S]}),s[17]=h,s[18]=B):B=s[18];let v;return s[19]!==B||s[20]!==C?(v=t.jsxs("div",{className:"relative",children:[C,B]}),s[19]=B,s[20]=C,s[21]=v):v=s[21],v}function hp(){_e.logEventWithStatsig("Thread Join Workspace Banner Button Shown","chatgpt_thread_join_workspace_banner_button_shown")}const Io=St({bannerBody:{id:"WAgvN5",defaultMessage:"Unlock extra messages, images & more"},dismissBanner:{id:"+X3EGU",defaultMessage:"Dismiss banner"}}),xp=7*24*60*60*1e3;function bp(s,e){const n=Date.parse(s.dismissedAt);return Number.isNaN(n)?!0:Date.now()-n>e}function Sp(s){const e=hs.getItem(xs.ThreadUpgradeBannerDismissedAt);return e?bp(e,s):!0}function Ia({isDismissible:s,dismissTtlMs:e=xp}){const[n,i]=g.useState(!1);return g.useEffect(()=>{if(!s){i(!0);return}i(Sp(e))},[e,s]),{isVisible:n,dismiss:()=>{if(!s)return;_e.logEventWithStatsig("Thread Upgrade Banner Button Dismissed","chatgpt_thread_upgrade_banner_button_dismissed",{type:"banner"});const a={dismissedAt:new Date().toISOString()};hs.setItem(xs.ThreadUpgradeBannerDismissedAt,a),i(!1)}}}function Kf({isDismissible:s=!0}){const e=is(),{isVisible:n,dismiss:i}=Ia({isDismissible:s});if(g.useEffect(()=>{n&&_e.logEventWithStatsig("Thread Upgrade Banner Button Shown","chatgpt_thread_upgrade_banner_button_shown",{type:"banner"})},[n]),!n)return null;const r=()=>{_e.logEventWithStatsig("Thread Upgrade Banner Button Clicked","chatgpt_thread_upgrade_banner_button_clicked",{type:"banner"}),Ns(e,"thread_splash_upgrade_banner_cta")};return t.jsxs("div",{className:"relative",children:[t.jsxs("button",{type:"button",onClick:r,className:ye("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden",s&&"pe-7",!s&&"pe-4"),children:[t.jsxs("span",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:t.jsx(Ls,{className:"icon-sm","aria-hidden":"true"})}),t.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:t.jsx(ce,me({},Io.bannerBody))})]}),t.jsxs("span",{className:ye("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:[t.jsx("span",{className:"hidden sm:inline",children:t.jsx(ce,me({},We.upgradePlan))}),t.jsx("span",{className:"sm:hidden",children:t.jsx(ce,me({},We.upgrade))}),!s&&t.jsx(Si,{className:"icon-xs"})]})]}),s&&t.jsxs("button",{type:"button",onClick:a=>{a.stopPropagation(),i()},className:ye("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),children:[t.jsx(ha,{className:"icon-xs","aria-hidden":"true"}),t.jsx("span",{className:"sr-only",children:t.jsx(ce,me({},Io.dismissBanner))})]})]})}var Ua=(s=>(s.GENERIC="generic",s.GENERIC_FREE_TRIAL="generic_free_trial",s.GO="go",s.PLUS="plus",s.BANNER="banner",s))(Ua||{});function _p({clientThreadId:s,variant:e}){var T;const n=Pe(),i=Pc(),{enableThreadHeaderUpgradePill:r}=Ec(),{enableNewSplashUpgradeBanner:a,newUpsellsDismissible:c}=Mc(),{isVisible:o}=Ia({isDismissible:c()}),d=tn(s),u=Ge(s,S=>Ne.hasUserMessage(S)),m=_i(),b=Ue(n,"4048646334"),C=(T=m==null?void 0:m.call_to_action)==null?void 0:T.includes(yi.GET_PLUS),x=i&&(d&&!u)&&r&&!(C&&!b.get("should_show_thread_header_upgrade_pill",!0));return e==="banner"?{shouldShow:x&&o&&a(),newUpsellsDismissible:c}:{shouldShow:x&&!a(),newUpsellsDismissible:()=>!1}}function Qf(){const s=Pe(),e=ht(),{eligible:n}=vc(),{eligible:i}=Rc(),r=n||i;if(!e)return null;let a="generic";if(r)a="generic_free_trial";else if(Ai(s))a="go";else{const o=Ue(s,"497415788").get("upgrade_pill_type","plus");if(kp(o))a=o;else return null}switch(a){case"generic":return t.jsx(Cp,{});case"generic_free_trial":return t.jsx(wp,{});case"plus":return t.jsx(yp,{});case"go":return t.jsx(Ap,{});case"banner":return null}}function yp(){const s=is(),e=Pe(),n=()=>{Ns(s,"thread_header_get_plus_pill")};return t.jsxs(_t,{onClick:n,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"plus",children:[t.jsx(Ls,{className:"icon-sm"}),t.jsx(ce,me({},jp(e)))]})}function Ap(){const s=is(),e=()=>{Ns(s,"thread_header_get_plus_pill")};return t.jsxs(_t,{onClick:e,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"go",children:[t.jsx(Bc,{className:"icon-sm"}),t.jsx(ce,me({},We.upgradeToGo))]})}function Cp(){const s=is(),e=()=>{Ns(s,"thread_header_generic_upgrade_pill_button")};return t.jsxs(_t,{onClick:e,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic",children:[t.jsx(Ls,{className:"icon-sm"}),t.jsx(ce,me({},We.upgrade))]})}function wp(){const s=is(),e=()=>{Ns(s,"thread_header_generic_free_trial_upgrade_pill_button")};return t.jsxs(_t,{onClick:e,className:"bg-[#F1F1FB] text-[#5D5BD0] hover:bg-[#E4E4F6] dark:bg-[#373669] dark:text-[#DCDBF6] dark:hover:bg-[#414071]",type:"generic_free_trial",children:[t.jsx(Ls,{className:"icon-sm"}),t.jsx(ce,me({},We.upgradeForFree))]})}function _t({children:s,className:e,onClick:n,type:i}){g.useEffect(()=>{_e.logEventWithStatsig("Thread Header Upgrade Pill Button Shown","chatgpt_thread_header_upgrade_pill_button_shown",{type:i})},[i]);const r=()=>{_e.logEventWithStatsig("Thread Header Upgrade Pill Button Clicked","chatgpt_thread_header_upgrade_pill_button_clicked",{type:i}),n()};return t.jsx("button",{onClick:r,className:ye("flex items-center gap-1 rounded-full py-2 ps-2.5 pe-3 text-sm font-medium",e),children:s})}function kp(s){return Object.values(Ua).includes(s)}function jp(s){switch(Ue(s,"497415788").get("plus_upgrade_pill_cta","get_plus")){case"try_plus":return We.tryPlus;case"upgrade_to_plus":return We.upgradeToPlus;case"upgrade_your_plan":return We.upgradeYourPlan;case"upgrade_plan":return We.upgradePlan;case"get_plus":default:return We.getPlus}}function Uo({clientThreadId:s,onClick:e}){g.useEffect(()=>{Gc(s)},[s]);const n=Ie();return t.jsx(Os.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:t.jsx(_a,{onClick:()=>{Hc(s),e()},label:n.formatMessage(sn.moreStarterPrompts)})})}function Tp({starterPrompt:s,starterPrompts:e,index:n,disabled:i,onSelectStarterPrompt:r}){var u;const a=(u=s.theme)!=null?u:s.title,c=Lc(),{mutate:o}=Ic(),d=s.category==="onboarding"?m=>{o({key:rs.hasUsedConversationalOnboardingStarterPrompt}),c(m,s,e,n)}:m=>r==null?void 0:r(m,s,e,n);return t.jsx(_a,{disabled:i,onClick:d,icon:t.jsx(Uc,{category:s.category,useV2Colors:!0}),label:a})}const Pp=5,Ep=3;function Ga({starterPrompts:s,onSelectStarterPrompt:e,disabled:n,clientThreadId:i,onExpand:r,mobileLayout:a=!1}){const c=a?Ep:Pp,[o,d]=g.useState(c),[u,m]=g.useState(!1),b=g.useRef(null),C=s.length<=o;g.useEffect(()=>{ko(s.slice(0,c),i)},[i]),g.useEffect(()=>{if(!u&&!C&&b.current){const x=b.current,T=x.getBoundingClientRect(),S=T.width,B=Array.from(x.children);let v=0;for(let N=0;N<B.length&&B[N].getBoundingClientRect().right-T.left<=S;N++)v++;d(v),m(!0)}},[s,C,u]);const h=()=>{const x=s.slice(o,s.length).map(T=>os(me({},T),{isAdditional:!0}));x.length>0&&ko(x,i),d(s.length),r()};return t.jsxs("div",{"data-testid":"starter-prompt-chips",className:ye("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",u&&s.length>0?"opacity-100":"opacity-[0.01]",a?"flex-wrap":"flex-nowrap"),children:[t.jsxs("ul",{className:ye("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",C||a?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:b,children:[s.slice(0,o).map((x,T)=>{var S;return t.jsx(Os.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:t.jsx(Tp,{starterPrompt:x,starterPrompts:s,index:T,disabled:n,onSelectStarterPrompt:e})},(S=x.id)!=null?S:T)}),a&&s.length>o&&t.jsx(Uo,{clientThreadId:i,onClick:h})]}),!a&&s.length>o&&t.jsx(Uo,{clientThreadId:i,onClick:h})]})}const Xf=({clientThreadId:s,currentModelId:e,isModelLoaded:n})=>{const[i,r]=g.useState(!1),a=xt(),{prospectiveModelId:c}=ba(s),o=n?e:c!=null?c:"auto",{promptStarters:d,shouldShowStarterPrompts:u,onSelectStarterPrompt:m}=Sa({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:s,limit:8,modelSlug:o});return t.jsx(Os.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:ye(u&&!i&&"h-[116px]"),children:u&&d&&t.jsx(Ga,{starterPrompts:d,onSelectStarterPrompt:m,disabled:a,clientThreadId:s,onExpand:()=>r(!0),mobileLayout:!0})})},Zf=({currentModelId:s,clientThreadId:e,isModelLoaded:n})=>{const{isUnauthenticated:i}=on(),r=Oc(),[a,c]=g.useState(!1),o=xt(),{prospectiveModelId:d}=ba(e),u=n?s:d!=null?d:"auto",{promptStarters:m,shouldShowStarterPrompts:b,onSelectStarterPrompt:C}=Sa({isModelLoaded:n,shouldBeEnabledForDefaultAssistant:!0,clientThreadId:e,limit:8,modelSlug:u}),{shouldShow:h}=_p({clientThreadId:e,variant:"banner"}),{shouldShow:x}=mp({clientThreadId:e,canShowBanner:!h}),T=b&&m;return(x||h)&&!T?null:t.jsx(Os.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:ye("max-w-full max-sm:hidden",!r&&"min-h-[108px]",i&&a||r?"":"h-[70px]"),children:T&&t.jsx(Ga,{starterPrompts:m,onSelectStarterPrompt:C,disabled:o,clientThreadId:e,onExpand:()=>c(!0)})})};function Mp({className:s,layout:e="grid",hideShuffleButton:n}){const i=Ie(),r=xt(),a=Nc(),c=Wo(),o=ve(xa(c).shouldShowAutocomplete$),[d,u]=g.useState(wo(a,[],4,e==="carousel"?1:2)),m=()=>{u(wo(a,d,4,2))};return!a||a.length===0?null:t.jsxs("div",{className:ye("flex w-full flex-col gap-y-4 transition-opacity",s,o?"pointer-events-none opacity-0":"opacity-100"),children:[t.jsxs("div",{className:"flex items-center justify-between px-1",children:[t.jsx("div",{className:"text-token-text-secondary text-base leading-7 sm:text-sm",children:i.formatMessage(sn.trySomethingNew)}),!n&&t.jsx(Ci,{type:"button",onClick:m,label:i.formatMessage(sn.shuffleTiles),color:"ghost",size:"medium",icon:Dc})]}),t.jsx("div",{"data-testid":"starter-prompt-tiles",className:ye(e==="grid"?"grid grid-cols-2 gap-4 sm:flex sm:flex-row":"-mx-(--thread-content-margin) flex flex-row gap-3 overflow-x-auto px-(--thread-content-margin) pb-4 sm:gap-4"),children:Array.from({length:4}).map((b,C)=>{const h=d[C];return h?t.jsx("div",{className:ye("max-sm:short:h-[116px] relative h-[132px] sm:h-[144px]",e==="carousel"?"flex-1 max-sm:w-[164px] max-sm:flex-none":"w-full flex-1 sm:basis-0"),children:t.jsx(_c,{initial:!1,children:t.jsx(Os.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeOut"},className:"absolute inset-0 h-full w-full",children:t.jsx(Fc,{starterPrompt:h,allPrompts:a,index:C,disabled:r,className:"h-full w-full"})},h.id)})},C):t.jsx("div",{},C)})})]})}const sn=St({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"},trySomethingNew:{id:"StarterPromptTiles.trySomethingNew",defaultMessage:"Try something new"},shuffleTiles:{id:"StarterPromptTiles.shuffle",defaultMessage:"Shuffle"}}),vp=an(()=>rn(()=>import("./n3zqaiyl90r8ot1y.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(s=>s.JawboneNotificationsBanner)),Rp=g.memo(function({className:e}){const{store:n}=De(),i=n.useIsHeaderContentAreaPopulated(),a=n.useContentAreaId(Ss.HeaderTop)===j.AgentModeAnnouncementBanner?"z-0":Wc.PromptTextareaHeader;return t.jsx("div",{className:ye(e!=null?e:"absolute start-0 end-0 bottom-full",a),children:t.jsx(zc,{shouldRender:i,contentArea:Ss.Header,children:t.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[t.jsx(Bp,{}),t.jsx(Np,{})]})})})});function Bp(){const s=Pe(),{store:e}=De(),n=e.useSharedProps(d=>d==null?void 0:d.clientThreadId),i=e.useContentAreaId(Ss.HeaderTop),r=qc(),a=Ge(n,d=>d==null?void 0:d.modelId),c=Ds(Fs);let o;switch(i){case j.ProjectConversationTaskNoFileAccess:o=t.jsx(Lp,{});break;case j.AdvancedVoiceOnMobileAnnouncement:o=t.jsx(uu,{clientThreadId:n});break;case j.S09KM1:o=null;break;case j.BannerSignup:o=t.jsx(Op,{});break;case j.BannerTermsDisclaimer:o=t.jsx(Ip,{});break;case j.NewUserBannerTermsDisclaimer:o=t.jsx(Up,{});break;case j.PromptTextareaAction:o=t.jsx(Gp,{});break;case j.BannersRateLimit:o=t.jsx(Hp,{});break;case j.BannersBeaconUI:o=t.jsx(Wp,{});break;case j.BannerSidekickAnnouncement:o=t.jsx(cu,{});break;case j.SearchBrowserExtensionAnnouncement:o=t.jsx(lu,{});break;case j.MoonshineAnnouncement:o=t.jsx(iu,{});break;case j.GoldenHourAnnouncementBanner:o=!1;break;case j.SearchBrowserExtensionReactiveAnnouncement:o=t.jsx(ru,{});break;case j.BannerMemoryAlmostFull:o=t.jsx(To,{memoryAlmostFullVariant:!0});break;case j.BannerMemoryFull:o=t.jsx(To,{});break;case j.Box:o=t.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",t.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",t.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case j.JawboneAnnouncement:r?o=t.jsx(vp,{}):o=null;break;case j.JawboneMaxActiveAnnouncement:r?o=t.jsx(au,{}):o=null;break;case j.PromoRedemptionAnnouncement:o=t.jsx(ep,{});break;case j.OperatorAnnouncement:o=t.jsx(ou,{});break;case j.BannerPlusUpsell:o=t.jsx(nu,{});break;case j.BannerNoAuthTrials:o=t.jsx(tu,{});break;case j.ReferrerRedemptionAvailableAnnouncement:o=t.jsx(cp,{});break;case j.RefereeRedemptionAvailableAnnouncement:o=t.jsx(su,{});break;case j.ReferralProgramUpsellAnnouncement:o=t.jsx(eu,{});break;case j.TatertotIntakeFormAnnouncement:o=!1;break;case j.StudentsUpsellAnnouncement:o=t.jsx(Zc,{});break;case j.ModelDeprecationBanner:o=Xc(a);break;case j.TeamSeatsPromoAnnouncement:o=t.jsx(Qc,{});break;case j.TeamsContextualAnswersUpsell:o=t.jsx(Kc,{});break;case j.AgentModeAnnouncementBanner:o=wi(s)&&!c&&t.jsx(Vc,{});break;case j.LanguageUpsellBanner:o=t.jsx(Yc,{onDismissSideEffect:()=>{_e.logEventWithStatsig("Language Upsell Banner Dismissed","chatgpt_web_language_upsell_banner_dismissed"),jo.set(s,!0)},onPrimaryCtaClickSideEffect:()=>{_e.logEventWithStatsig("Language Upsell Banner Primary CTA Clicked","chatgpt_web_language_upsell_banner_primary_cta_clicked"),jo.set(s,!0)}});break;case j.StarterPrompts:o=t.jsx(Mp,{hideShuffleButton:!0,layout:"carousel"});break;case j.ImageGenBanner:o=t.jsx(Jc,{className:"mb-3"});break;case j.SystemHintSuggestion:o=t.jsx($c,{});break;default:o=null;break}return o}function Np(){const{store:s}=De(),e=s.useContentAreaId(Ss.HeaderBottom);let n;switch(e){case ya.DallePromptControls:n=t.jsx(Fp,{});break;default:n=null;break}return n}const Dp=an(()=>rn(()=>import("./n52e1vlj3htmeq8c.js"),__vite__mapDeps([7,1,2,3,4,5])).then(s=>s.default));function Fp(){const{store:s}=De(),e=s.useSharedProps(n=>n==null?void 0:n.composerController);return e?t.jsx(Dp,{composerController:e}):null}function Op(){const{store:s}=De(),e=s.useSharedProps(r=>r==null?void 0:r.clientThreadId),n=ki(),i=hu();return e?n?t.jsx(xu,{threadId:e,showSignUp:i}):t.jsx(bu,{threadId:e,showLogin:i}):null}function Lp(){return g.useEffect(()=>()=>{hs.getItem(xs.TasksHasSeenProjectDisclaimerBanner)||hs.setItem(xs.TasksHasSeenProjectDisclaimerBanner,!0)},[]),t.jsx(Go,{icon:t.jsx(ji,{}),title:t.jsx(ce,{id:"ibX3g7",defaultMessage:"Tasks canâ€™t access project files"}),content:t.jsx(ce,{id:"fm94Tm",defaultMessage:"Thereâ€™s a task in this conversation â€” just FYI, it wonâ€™t be able to access project files."}),onDismiss:()=>{hs.setItem(xs.TasksHasSeenProjectDisclaimerBanner,!0)}})}function Ip(){const{store:s}=De(),e=s.useSharedProps(n=>n==null?void 0:n.clientThreadId);return e?t.jsx(gu,{threadId:e}):null}function Up(){const{store:s}=De(),e=s.useSharedProps(n=>n==null?void 0:n.clientThreadId);return e?t.jsx(fu,{threadId:e}):null}function Gp(){const{store:s}=De(),e=s.useSharedProps();return e?t.jsx(pu,me({},e)):null}function Hp(){const{store:s}=De(),e=s.useSharedProps(i=>i==null?void 0:i.clientThreadId),n=s.useSharedProps(i=>i==null?void 0:i.composerController);return!e||!n?null:t.jsx(mu,{clientThreadId:e,composerController:n})}function Wp(){const{store:s}=De(),e=s.useSharedProps(r=>r==null?void 0:r.openFileDialog),n=s.useSharedProps(r=>r==null?void 0:r.clientThreadId),i=s.useSharedProps(r=>r==null?void 0:r.composerController);return!n||!i||!e?null:t.jsx(du,{clientThreadId:n,openFileDialog:e})}const zp=5,qp=g.memo(function(e){return Vp(e),$p(e),Su({clientThreadId:e.clientThreadId,composerController:e.composerController,openFileDialog:e.openFileDialog}),Jp(),null});function Vp(s){const{store:e}=De(),n=e.useSetSharedProps();Kt(()=>{n(s)},[s,n])}function $p(s){const{clientThreadId:e,canContinue:n}=s,{store:i}=De(),r=Pe(),a=g.useRef({top:i.useContentAreaApi(Ss.HeaderTop),bottom:i.useContentAreaApi(Ss.HeaderBottom)}).current,c=_u(e),{shouldShowBannerSignup:o,shouldShowBannerTermsDisclaimer:d}=Yp(e),{isOpen:u}=yu(),m=Au(e),b=Cu(e),C=wu(s);ku(s);const h=ju(),x=Tu(s),{shouldShowMemoryFull:T,shouldShowMemoryAlmostFull:S}=Pu(e),B=Eu(s),v=Mu(e),N=vu(e),f=sp(),{eligible:P}=ss(Ru),E=Bu(),p=Nu(),A=Du(),H=Fu(),{eligible:Y}=ss(rs.hasSeenTeamSeatsPromoAnnouncement),q=Ou(e),W=Lu(e),F=Iu(),D=Uu(),K=Gu(e),V=Ge(e,Q=>Q==null?void 0:Q.modelId),U=Aa(e),se=bt(),ae=Ca(),{eligible:Ae}=ss(rs.hasSeenAgentModeAnnouncementBanner),fe=ve(()=>Hu(Ti(r,e)).activeSystemHintSuggestionChip$()!=null),ue=Ae&&ae&&se!==ut,R=ln(),J=tn(e),w=Wu({shouldBeEnabledForDefaultAssistant:J&&!R,clientThreadId:e}),$=zu(),z=w==="hscroll",y=w==="image_gen_banner"&&$;Kt(()=>{d?a.top.set(j.BannerTermsDisclaimer):u?a.top.set(j.NewUserBannerTermsDisclaimer):V&&(U==null?void 0:U.kind)===pt.GizmoInteraction&&U.gizmo&&Pi(V,U.gizmo)?a.top.set(j.ProjectConversationTaskNoFileAccess):B.eligible?a.top.set(j.AdvancedVoiceOnMobileAnnouncement):m?a.top.set(j.BannersRateLimit):b?a.top.set(j.BannersBeaconUI):F?a.top.set(j.BannerPlusUpsell):D?a.top.set(j.BannerNoAuthTrials):v?a.top.set(j.JawboneAnnouncement):N?a.top.set(j.JawboneMaxActiveAnnouncement):C.eligible?a.top.set(j.BannerSidekickAnnouncement):h?a.top.set(j.MoonshineAnnouncement):x?a.top.set(j.SearchBrowserExtensionReactiveAnnouncement):f?a.top.set(j.PromoRedemptionAnnouncement):P?a.top.set(j.OperatorAnnouncement):A?a.top.set(j.ReferralProgramUpsellAnnouncement):n?a.top.set(j.PromptTextareaAction):o?a.top.set(j.BannerSignup):S&&zo(r,"1206459705").get("upsell_variant","control")!=="control"?a.top.set(j.BannerMemoryAlmostFull):T?a.top.set(j.BannerMemoryFull):E?a.top.set(j.ReferrerRedemptionAvailableAnnouncement):p?a.top.set(j.RefereeRedemptionAvailableAnnouncement):H?a.top.set(j.StudentsUpsellAnnouncement):Y?a.top.set(j.TeamSeatsPromoAnnouncement):q?a.top.set(j.ModelDeprecationBanner):W?a.top.set(j.TeamsContextualAnswersUpsell):K?a.top.set(j.LanguageUpsellBanner):ue?a.top.set(j.AgentModeAnnouncementBanner):z?a.top.set(j.StarterPrompts):y?a.top.set(j.ImageGenBanner):fe?a.top.set(j.SystemHintSuggestion):a.top.set(null)},[a,se,n,d,u,o,m,C,T,B,ue,Y,z,y,fe]),Kt(()=>{c&&a.bottom.set(ya.DallePromptControls)},[a,c])}function Jp(){const{store:s}=De();g.useEffect(()=>()=>{s.reset()},[s])}function Yp(s){const e=Pe(),{isUnauthenticated:n}=on(),i=Ue(e,"3637408529",{disableExposureLog:!0}),a=Ue(e,"3637408529").get("no_auth_banner_signup_rate_limit",zp),c=i.get("should_show_no_auth_signup_banner",!0),o=qu(C=>C.bannerDisclaimerClientThreadId),d=Vu(),u={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1},[m,b]=Ge(s,C=>{var h;return[Ne.getConversationTurns(C).filter(x=>x.role===qo.User).length,Kp((h=Ne.getCurrentNode(C))==null?void 0:h.message)]});return s&&(u.shouldShowBannerTermsDisclaimer=b&&n&&m===1&&!d&&(o==null||o===s),u.shouldShowBannerSignup=c&&b&&n&&m>0&&m%a===0),u}function Kp(s){return(s==null?void 0:s.author.role)===qo.Assistant&&Ei(s)}function Qp({modelSupportedImageMimeTypes:s}){const e=Ds(Fs),n=Vo(),i=cn(),r=Ie();return e?t.jsx(le.Item,{icon:$u,onClick:async()=>{const a=await op();if(a)try{const c=atob(a.base64image),o=c.length,d=new Uint8Array(o);for(let m=0;m<o;m++)d[m]=c.charCodeAt(m);const u=new File([d],a.filename,{type:a.mimetype});Ju.uploadFile(n,u,s,r,i,void 0,void 0,vs.Multimodal)}catch(c){}},children:t.jsx(ce,{id:"HiFPUD",defaultMessage:"Attach screenshot"})},"attach_screenshot"):null}const Xp="manage-prompts",Zp=()=>({data:null,isLoading:!1});function Rs(s){return typeof s=="object"&&s!=null&&"command"in s}function ef(s){"use forget";const e=ts.c(11),{command:n,isHighlighted:i,onHighlight:r,onClick:a}=s;let c;e[0]!==n.title?(c=t.jsx("span",{className:"break-all",children:n.title}),e[0]=n.title,e[1]=c):c=e[1];let o;return e[2]!==n.disabled||e[3]!==n.icon||e[4]!==n.secondary||e[5]!==n.trailing||e[6]!==i||e[7]!==a||e[8]!==r||e[9]!==c?(o=t.jsx(Zo,{as:"div",hasManagedFocus:!0,disabled:n.disabled,highlighted:i,icon:n.icon,secondary:n.secondary,trailing:n.trailing,onPointerMove:r,onClick:a,children:c}),e[2]=n.disabled,e[3]=n.icon,e[4]=n.secondary,e[5]=n.trailing,e[6]=i,e[7]=a,e[8]=r,e[9]=c,e[10]=o):o=e[10],o}function sf({hint:s,isHighlighted:e,onHighlight:n,onClick:i}){"use no forget";const r=Ma(s.systemHint),a=t.jsx(Zo,{as:"div",hasManagedFocus:!0,disabled:r.isBlocked,highlighted:e,icon:t.jsx(td,{hint:s,isNextToLabel:!0}),secondary:r.blockedLabel,onPointerMove:n,onClick:i,children:t.jsx("span",{className:"break-all",children:s.name})});return r.remainingLabel?t.jsx(un,{side:"right",labelTextAlign:r.isBlocked?"left":"center",label:r.remainingLabel,secondaryLabel:r.remainingLabelSecondary,contentClassName:"cant-hover:hidden",triggerAs:null,children:a}):a}const tf=Ji(s=>{var e,n,i,r;return Rs(s)?{targets:[s.command,...(e=s.aliases)!=null?e:[],...(n=s.regexMatches)!=null?n:[],s.secondary?"".concat(s.title," ").concat(s.secondary):s.title],weight:s.matchWeight}:{targets:[s.systemHint,...(i=s.aliases)!=null?i:[],...(r=s.regexMatches)!=null?r:[],s.name]}});function nf({gptsSlashCommands$:s,modelSlashCommands$:e,libraryPromptSlashCommands:n,slashCommands:i,systemHints:r,composerController:a,clientThreadId:c,layoutMode:o}){"use forget";const d=Pe(),u=Pa(),m=is(),b=Ie(),{refs:C,floatingStyles:h}=Ii({placement:o==="center"?"bottom-start":"top-start",middleware:[Ui({mainAxis:10,alignmentAxis:-18}),Gi({padding:6}),Hi({apply:({elements:w,availableWidth:$,availableHeight:z})=>{w.floating.style.setProperty("--radix-popper-available-width","".concat($,"px")),w.floating.style.setProperty("--radix-popper-available-height","".concat(z,"px"))}})],whileElementsMounted:Wi}),[x,T]=g.useState(void 0);g.useEffect(()=>{const w=Se(a);w.dispatch(zi(w.state.tr,{setReferencePosition:C.setReference,onHintMatch($){T(z=>ea(z,$)?z:$)}}))},[a,C]);const S=Xu(),B=Xo(c),{setThreadSystemHintMode:v,clearAllSystemHintModeTriggers:N}=Zu(),f=Ds(Fs),P=ve(()=>x&&(s==null?void 0:s())),E=ve(()=>{var w;return(w=e==null?void 0:e())!=null?w:[]}),p=(x==null?void 0:x.triggerSymbol)==="@",A=!1,H=g.useCallback(()=>{},[d]),Y=g.useMemo(()=>p?f?[]:[P!=null?P:[]]:[i,r,E],[p,n,P,i,r,E,A,b,m,H,f]),{displayGroups:q,suggestions:W}=g.useMemo(()=>{if(!x)return{displayGroups:[],suggestions:[]};const w=x.text?[ed(Eo(Y),x.text,tf,{locale:b.locale})]:Y.map(z=>z.filter(y=>!Rs(y)||!y.noMatchEmpty)),$=o==="bottom"?w.reverse().map(z=>z.reverse()):w;return{displayGroups:$,suggestions:Eo($)}},[Y,x,o,b]),[F,D]=g.useState(o==="bottom"?-1:0),K=F==null?null:(F+W.length)%W.length,V=g.useCallback(w=>{D($=>{if($==null)return null;const z=W.length;for(let y=0;y<z;y++){const Q=($+z+(y+1)*w)%z,O=W[Q];if(!("systemHint"in O?S.includes(O.systemHint):O.disabled))return Q}return null})},[W,S]),U=dt(V),se=W.length,ae=se===0;g.useEffect(()=>{o==="bottom"?(D(0),U.current(-1)):(D(-1),U.current(1))},[se,o,U]);const Ae=K==null?null:W[K],fe=g.useCallback(()=>{if(x!=null&&x.range){const w=Se(a);qi(w,x.range.from,x.range.to)}},[x,a]),ue=({hintToSave:w=Ae,expectPerfectMatch:$})=>{var ge;if(!x||!w)return!1;const z=x.text.toLocaleLowerCase(),Q=(Rs(w)?w.command:w.name).toLocaleLowerCase()===z||((ge=w.aliases)==null?void 0:ge.some(ne=>ne.toLocaleLowerCase()===z));if($&&!Q)return!1;if(fe(),nt(Se(a)),Rs(w))return w.onSelect(),!0;_e.logEvent("System Hint Selected",{system_hint:w.systemHint,conversation_id:B!=null?B:It});const O={clientThreadId:c};N();const te=w.systemHint===I.Search;return v(w.systemHint,!0,O,te?sd.CONVERSATION_COMPOSER_SLASH_SEARCH:void 0),w.systemHint===I.Agent&&u==="show"&&bs(d,({onClose:ne})=>t.jsx(Ea,{clientThreadId:c!=null?c:It,onClose:ne,source:"slash_agent"})),!0},R=dt(ue);g.useEffect(()=>{const w=Se(a);return ae||Vi(w,$=>{if($==="up")U.current(-1);else if($==="down")U.current(1);else if($==="cancel")nt(w),Yi(w);else{if($==="submit")return nt(w),R.current({expectPerfectMatch:!1});if($==="checkMatch")return R.current({expectPerfectMatch:!0})}}),()=>nt(w)},[a,ae,Ae,fe,U,R]);const J=dt(B);return g.useEffect(()=>{var w;ae||_e.logEvent("System Hint List Opened",{conversation_id:(w=J.current)!=null?w:It})},[J,ae]),ae?null:t.jsx($i,{ref:C.setFloating,style:h,className:ye("max-w-[min(var(--radix-popper-available-width,100vw),--spacing(100))] overflow-y-auto [scrollbar-width:none]",W.length>6?"max-h-[min(var(--radix-popper-available-height,50svh),--spacing(1.5)+5*var(--menu-item-height))]":"max-h-[var(--radix-popper-available-height,50svh)]"),onPointerDown:w=>{w.preventDefault()},children:q.map((w,$)=>{let z=0;for(let y=0;y<$;y++)z+=q[y].length;return t.jsx(le.Group,{children:w.map((y,Q)=>{const O=z+Q;return Rs(y)?t.jsx(ef,{command:y,isHighlighted:O===K,onHighlight:()=>D(O),onClick:()=>{ue({hintToSave:y,expectPerfectMatch:!1}),Je(Se(a))}},y.command):t.jsx(sf,{hint:y,isHighlighted:O===K,onHighlight:()=>D(O),onClick:()=>{ue({hintToSave:y,expectPerfectMatch:!1}),Je(Se(a))}},y.systemHint)})},$)})})}function of(s){"use forget";var ne;const e=ts.c(82),{systemHints:n,availableSystemHints:i,composerController:r,clientThreadId:a,layoutMode:c,composerLayer:o,canUseInlineTagging:d,isFileUploadEnabled:u,fileUploadDisabledReason:m,currentModelConfig:b,openFileDialog:C,connectionInstanceData:h,setActiveSystemHintType:x,defaultModelId:T,selectModelId:S,gizmoId:B,hasGizmoFeatureRateLimit:v,setSelectedGizmoTag:N}=s,f=Pe(),P=Ie(),E=is(),{connectedTypes:p}=Mi(),A=nn();let H;e[0]!==A?(H=A!=null&&vi(A),e[0]=A,e[1]=H):H=e[1];const Y=H,{data:q}=$o(Jo.DeveloperMode),{isSingleLine:W,showModelSlashCommands:F}=o;h==null||h.connection_statuses;let D,K;if(e[2]!==a||e[3]!==p||e[4]!==(h==null?void 0:h.connection_statuses)||e[5]!==f||e[6]!==(b==null?void 0:b.title)||e[7]!==m||e[8]!==P||e[9]!==q||e[10]!==u||e[11]!==Y||e[12]!==W||e[13]!==E||e[14]!==C||e[15]!==x||e[16]!==n){if(K=[],W){let k;e[18]===Symbol.for("react.memo_cache_sentinel")?(k=["file","attach","photo"],e[18]=k):k=e[18];const L=!u,ee=b==null?void 0:b.title;let pe;e[19]!==f||e[20]!==m||e[21]!==P||e[22]!==L||e[23]!==ee?(pe=wa(f,P,L,m,ee),e[19]=f,e[20]=m,e[21]=P,e[22]=L,e[23]=ee,e[24]=pe):pe=e[24];let ke;e[25]===Symbol.for("react.memo_cache_sentinel")?(ke=t.jsx(ka,{"aria-label":"",className:"icon"}),e[25]=ke):ke=e[25];const Ee=!u;let je;e[26]!==C||e[27]!==pe||e[28]!==Ee?(je={command:"upload",aliases:k,title:pe,icon:ke,onSelect:C,disabled:Ee},e[26]=C,e[27]=pe,e[28]=Ee,e[29]=je):je=e[29],K.push(je)}let M;e[30]!==(h==null?void 0:h.connection_statuses)?(M=(ne=h==null?void 0:h.connection_statuses.filter(ff).map(pf))!=null?ne:[],e[30]=h==null?void 0:h.connection_statuses,e[31]=M):M=e[31];const X=M,oe=n==null?void 0:n.some(mf);if(Y&&(p.size>0||X.length>0)&&oe){let k;e[32]!==P?(k=P.formatMessage({id:"6YT2cp",defaultMessage:"Use all connectors"}),e[32]=P,e[33]=k):k=e[33];let L;e[34]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx(Yu,{}),e[34]=L):L=e[34];let ee;e[35]!==a||e[36]!==X||e[37]!==p||e[38]!==x?(ee=()=>{x(I.Slurm,{analyticsMetadata:{clientThreadId:a}}),$e(a,ke=>{var je,Re;const Ee=(Re=(je=ke.selectedSources)==null?void 0:je.get(I.Slurm))!=null?Re:new Set;ke.selectedSources==null&&(ke.selectedSources=new Map),ke.selectedSources.set(I.Slurm,new Set([...Ee,...p,...X]))})},e[35]=a,e[36]=X,e[37]=p,e[38]=x,e[39]=ee):ee=e[39];let pe;e[40]!==k||e[41]!==ee?(pe={command:"all-connectors",title:k,icon:L,noMatchEmpty:!0,onSelect:ee},e[40]=k,e[41]=ee,e[42]=pe):pe=e[42],K.push(pe)}if(q){let k;e[43]===Symbol.for("react.memo_cache_sentinel")?(k=["mcp"],e[43]=k):k=e[43];let L;e[44]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx(Ku,{}),e[44]=L):L=e[44];let ee;e[45]!==E?(ee={command:"add-mcp",aliases:k,title:"Add MCP",icon:L,noMatchEmpty:!0,onSelect:()=>{E(Ri(Yo.Connectors))}},e[45]=E,e[46]=ee):ee=e[46],K.push(ee)}e[2]=a,e[3]=p,e[4]=h==null?void 0:h.connection_statuses,e[5]=f,e[6]=b==null?void 0:b.title,e[7]=m,e[8]=P,e[9]=q,e[10]=u,e[11]=Y,e[12]=W,e[13]=E,e[14]=C,e[15]=x,e[16]=n,e[17]=K}else K=e[17];D=K;const V=D;let U,se;e[47]!==f||e[48]!==T||e[49]!==S||e[50]!==F?(se=ft(()=>{if(!F)return[];const{data:M}=Ko(f);if(!M)return[];const X=[];for(const oe of M.categories)oe.defaultModel!==T&&X.push({command:oe.defaultModel,title:oe.label,disabled:!1,icon:t.jsx(Po,{className:"icon"}),onSelect:()=>{S(oe.defaultModel,"slash menu")}});for(const oe of M.groups)for(const k of oe.modelIds){const L=M.models.get(k);if(L&&!L.tags.includes(Bi.HIDDEN)){let ee=L.title;X.push({command:L.id,title:ee,secondary:void 0,trailing:t.jsx(Ni,{children:oe.label}),noMatchEmpty:!0,matchWeight:.1,disabled:!1,icon:t.jsx(Po,{className:"icon"}),onSelect:()=>{S(L.id,"slash menu")}})}}return X}),e[47]=f,e[48]=T,e[49]=S,e[50]=F,e[51]=se):se=e[51],U=se;const ae=U;let Ae,fe;e[52]!==d||e[53]!==f||e[54]!==B||e[55]!==v||e[56]!==N?(fe=ft(()=>{var ee,pe,ke,Ee,je;if(!d)return[];const{data:M}=Di(f),{data:X}=Fi(f),{data:oe}=Qu(f),k=ja([...(ee=M==null?void 0:M.items)!=null?ee:[],...(ke=(pe=X==null?void 0:X.list.items)==null?void 0:pe.map(df))!=null?ke:[],...He(f,"773249106")?(je=(Ee=oe==null?void 0:oe.items)==null?void 0:Ee.map(uf))!=null?je:[]:[]],cf);return(B?k.filter(Re=>Re.gizmo.id!==B):k).map(Re=>{var ls;return{command:Re.gizmo.display.name,title:Re.gizmo.display.name,disabled:v,icon:t.jsx(Ta,{simple:!0,isFirstParty:((ls=Re.gizmo.tags)==null?void 0:ls.includes(Qo.FirstParty))===!0,src:Re.gizmo.display.profile_picture_url,className:"icon",alt:""}),onSelect:()=>{_e.logEventWithStatsig("Composer GPT Selected","chatgpt_web_composer_gpt_selected",{gizmo:Re.gizmo.id}),N(Re)}}})}),e[52]=d,e[53]=f,e[54]=B,e[55]=v,e[56]=N,e[57]=fe):fe=e[57],Ae=fe;const ue=Ae;let R;e[58]!==f?(R=!1,e[58]=f,e[59]=R):R=e[59];const J=R;let w;e[60]!==J?(w={enabled:J},e[60]=J,e[61]=w):w=e[61];const{data:$}=Zp();let z;e[62]!==a||e[63]!==r||e[64]!==E||e[65]!==x?(z=M=>{var oe,k,L;const X=Se(r);if(Oi(X,"@"),M===Xp){E("/library?tab=prompts");return}if($e(a,lf),_e.logEventWithStatsig("chatgpt_web_prompt_used","chatgpt_web_prompt_used",{referer:"at_cmd",hint:(oe=M.system_hint)!=null?oe:"none",sources:((k=M.sources)!=null?k:[]).join(",")}),Li(X,M.prompt),M.system_hint&&(x(M.system_hint),(L=M.sources)!=null&&L.length)){const ee=M.sources.map(rf).filter(Qt),pe=M.system_hint,ke=new Set(ee.filter(af)),Ee=new Set(ee.filter(gs));$e(a,je=>{je.selectedSources=new Map([[pe,ke]]),je.selectedMCPSources=new Map([[pe,Ee]]),je.hasModifiedSources=!0})}},e[62]=a,e[63]=r,e[64]=E,e[65]=x,e[66]=z):z=e[66];const y=z;let Q;e:{if(!J){let X;e[67]===Symbol.for("react.memo_cache_sentinel")?(X=[],e[67]=X):X=e[67],Q=X;break e}let M;e[68]!==y||e[69]!==($==null?void 0:$.prompts)?(M=$==null?void 0:$.prompts.map(X=>({command:X.name,title:X.name,icon:void 0,onSelect:()=>{y(X)}})),e[68]=y,e[69]=$==null?void 0:$.prompts,e[70]=M):M=e[70],Q=M}const O=Q;let te;e[71]!==i?(te=i!=null?i:[],e[71]=i,e[72]=te):te=e[72];let ge;return e[73]!==a||e[74]!==r||e[75]!==ue||e[76]!==c||e[77]!==O||e[78]!==ae||e[79]!==V||e[80]!==te?(ge=t.jsx(nf,{gptsSlashCommands$:ue,modelSlashCommands$:ae,libraryPromptSlashCommands:O,slashCommands:V,systemHints:te,composerController:r,clientThreadId:a,layoutMode:c}),e[73]=a,e[74]=r,e[75]=ue,e[76]=c,e[77]=O,e[78]=ae,e[79]=V,e[80]=te,e[81]=ge):ge=e[81],ge}function af(s){return!gs(s)}function rf(s){return s.trim()}function lf(s){s.isUsingPromptTemplate=!0}function cf(s){return s.gizmo.id}function uf(s){return s.gizmo}function df(s){return s.resource}function mf(s){return s.systemHint===I.Slurm}function pf(s){return s.user_connection_details.connection_type}function ff(s){return s.user_connection_details.activation_status==="activated"&&["google_drive_oauth","google_drive_dwd"].includes(s.user_connection_details.knowledge_connector_type)}function gf(s){"use forget";const e=ts.c(30),{clientThreadId:n,modelSupportedImageMimeTypes:i,openFileDialog:r,historyDisabled:a,isDisabled:c,highlightTooltip:o,disabledReason:d,currentModelName:u,isLoadingConnectors:m,connectorConfig:b,onSelectConnector:C,onConnectorOauthRedirect:h,showLabel:x,showUpsell:T,hideBorder:S,isSmall:B,showMenuForNoAuth:v,visualTreatment:N}=s,f=Ki(),{gdriveStatus:P,o365Status:E}=Qi(),{isUnauthenticated:p}=on(),A=a?"text-white":o?"text-brand-blue-800":"",H=!T&&(P!=="false"||E!=="false"||f),{loggedOutAttachPlusIcon:Y}=dn(),q=p&&!Y?ka:nd;let W;e[0]!==A?(W=ye("icon",A),e[0]=A,e[1]=W):W=e[1];let F;e[2]!==q||e[3]!==W?(F=t.jsx(q,{"aria-label":"",className:W}),e[2]=q,e[3]=W,e[4]=F):F=e[4];const D=F,K=i.length>0;let V;e[5]!==n||e[6]!==b||e[7]!==u||e[8]!==d||e[9]!==S||e[10]!==o||e[11]!==D||e[12]!==c||e[13]!==m||e[14]!==B||e[15]!==p||e[16]!==i||e[17]!==K||e[18]!==h||e[19]!==C||e[20]!==r||e[21]!==H||e[22]!==x||e[23]!==v||e[24]!==T||e[25]!==N?(V=H?t.jsx(od,{clientThreadId:n,icon:D,showLabel:p&&x,modelSupportedImageMimeTypes:i,isLoadingConnectors:m,connectorConfig:b,onSelectConnector:C,onConnectorOauthRedirect:h,openFileDialog:r,isDisabled:c,highlightTooltip:o,disabledReason:d,currentModelName:u}):t.jsx(rp,{isSmall:B,hideBorder:S,clientThreadId:n,openFileDialog:r,showLabel:x,showUpsell:T,icon:D,isDisabled:c,highlightTooltip:o,disabledReason:d,currentModelName:u,visualTreatment:N,showMenuForNoAuth:v,modelSupportsImages:K}),e[5]=n,e[6]=b,e[7]=u,e[8]=d,e[9]=S,e[10]=o,e[11]=D,e[12]=c,e[13]=m,e[14]=B,e[15]=p,e[16]=i,e[17]=K,e[18]=h,e[19]=C,e[20]=r,e[21]=H,e[22]=x,e[23]=v,e[24]=T,e[25]=N,e[26]=V):V=e[26];const U=V;let se;return e[27]!==U||e[28]!==o?(se=t.jsx(ad,{showBackground:o,className:"bg-brand-blue-800/20",children:U}),e[27]=U,e[28]=o,e[29]=se):se=e[29],se}const Yt=6,hf=(s,e=!1)=>{const n=s.some(r=>!r.disabled),i=e?[...s]:n?s.filter(r=>!r.disabled):[...s];return i.sort((r,a)=>r.connected&&!a.connected?-1:!r.connected&&a.connected?1:r!=null&&r.isAutoConnected&&!(a!=null&&a.isAutoConnected)||r.type==="web"&&a.type!=="web"?-1:r.type!=="web"&&a.type==="web"?1:r.name.localeCompare(a.name)),i};function as(s){switch(s.user_connection_details.activation_status){case"activated":case"partially_activated":return!0;case"activating":case"inactive":return!1}}const yt=s=>{var e;return(e=Sf[s.user_connection_details.connection_type])!=null?e:s.connection_display_info.display_name},xf=new Set(["gdrive_sync_connector","slack_sync_connector","github_sync_connector","notion_sync_connector","sharepoint_admin_sync_connector","confluence_sync_connector"]),bf=({isLoading:s=!1,clientThreadId:e,enabledConnectors:n,includeWebSearch:i=!0,includeCloudBrowser:r=!1,includeSyncConnectors:a=!1,syncConnectorFilterFn:c,connectorConfigMap:o,fetchValidLinksOnly:d,systemHintType:u,selectedSources:m,selectedMCPSources:b,showConnectMore:C=!0,toggleSource:h,contentRef:x})=>{"use forget";const T=Ie(),S=oa(),B=ht(),v=!!(B!=null&&B.isPersonalAccount()&&S),{openSettings:N}=Xi(),f=Pe(),P=Ge(e,R=>R==null?void 0:R.startedWithMcp),E=P===!1,p=P===!0,{connectorLinks:A,isLoading:H}=Zi({fetchValidLinksOnly:d}),{allAutoConnectors:Y}=pn({getDisabledAutoConnectors:!1}),{connectionInstanceData:q,refetch:W,isLoading:F}=mn({skip:!a}),D=g.useMemo(()=>{var R,J,w;return c?(J=(R=q==null?void 0:q.connection_statuses)==null?void 0:R.filter($=>c($.user_connection_details.connection_type)))!=null?J:[]:(w=q==null?void 0:q.connection_statuses)!=null?w:[]},[q,c]),K=g.useMemo(()=>new Set(D.map(R=>R.user_connection_details.connection_type).filter((R,J,w)=>w.indexOf(R)!==J)),[D]),{enabledConnectors:V,connectorConfigMap:U,connectorLinks:se}=g.useMemo(()=>{if(!a)return{enabledConnectors:n,connectorConfigMap:o,connectorLinks:A};const R=uo[Me.GDRIVE_ACTION_CONNECTOR],J=A.has(R),w=D.some(O=>O.user_connection_details.connection_type==="gdrive_sync_connector"),$=D.some(O=>O.user_connection_details.connection_type==="gdrive_sync_connector"&&as(O));let z=[...n];const y=new Map(o),Q=new Map(A);return J&&!z.some(O=>O.type===Me.GDRIVE_ACTION_CONNECTOR)&&!w?(z.push({id:uo[Me.GDRIVE_ACTION_CONNECTOR],type:Me.GDRIVE_ACTION_CONNECTOR,name:"Google Drive",description:"",logo_url:ud,connector_type:"SERVICE",service:"",base_url:null,actions:[],supported_auth:[],owners:[],access_list:[],conformance:{implements_retrievable:!0}}),y.set(Me.GDRIVE_ACTION_CONNECTOR,{disabled:!0,disabledText:T.formatMessage(ze.contactAdmin),hasBetaTag:!1}),Q.delete(R)):v&&$&&(z=z.filter(O=>{var te;if(O.type===Me.GDRIVE_ACTION_CONNECTOR){const ge=(te=Q.get(O.id))==null?void 0:te[0];if(D.some(ne=>ne.user_connection_details.backing_link_id===(ge==null?void 0:ge.id)))return!1}return!0})),D.forEach(O=>{as(O)&&O.user_connection_details.backing_link_id&&Q.forEach((te,ge)=>{te.some(ne=>ne.id===O.user_connection_details.backing_link_id)&&(z=z.filter(ne=>ne.id!==ge))})}),{enabledConnectors:z,connectorConfigMap:y,connectorLinks:Q}},[a,A,D,n,o,v,T]),{connectedRows:ae,disconnectedRows:Ae}=g.useMemo(()=>{var z;const R=[];i&&R.push({connected:!0,type:"web",name:"web",element:t.jsx(le.CheckboxItem,{icon:va,disabled:p,checked:m==null?void 0:m.has("web"),onCheckedChange:()=>{h("web")},children:T.formatMessage(ze.webSearch)})}),r&&R.push({connected:!0,type:"cloud",name:"cloud",element:t.jsx(le.CheckboxItem,{icon:Ra,disabled:p,checked:m==null?void 0:m.has("cloud"),onCheckedChange:()=>{h("cloud")},children:T.formatMessage(ze.cloudBrowser)})}),a&&D.forEach(y=>{var Q,O,te;if(!(v&&y.user_connection_details.connection_type==="gdrive_sync_connector"&&!as(y))){{if(!as(y)&&y.user_connection_details.backing_link_id)return;if(y.user_connection_details.connection_type==="github_sync_connector")return;if(!as(y)&&!xf.has(y.user_connection_details.connection_type))return}R.push({connected:y.user_connection_details.auth_status!=="not_connected"&&y.user_connection_details.activation_status!=="inactive",isAutoConnected:!1,type:"sync",name:yt(y),element:t.jsx(Wa,{connection:y,disabled:(Q=U==null?void 0:U.get("sync_connector"))==null?void 0:Q.disabled,disabledText:(O=U==null?void 0:U.get("sync_connector"))==null?void 0:O.disabledText,isSelectedInSource:(te=m==null?void 0:m.has(y.user_connection_details.connection_type))!=null?te:!1,location:"user_dropdown",refetch:W,showDetails:K.has(y.user_connection_details.connection_type),toggleSource:h},y.user_connection_details.connection_instance_id)})}}),m&&V.forEach(y=>{var te,ge,ne,M,X,oe,k;const O=!!((te=se.get(y.id))==null?void 0:te[0]);if(y.type===aa.MCP_CONNECTOR)R.push({connected:O,type:"access",name:y.name,element:t.jsx(_f,{connector:y,connectorLinks:se,selectedMCPSources:b,toggleSource:h,systemHintType:u,disabled:E})});else{let L=p||((ne=(ge=U==null?void 0:U.get(y.type))==null?void 0:ge.disabled)!=null?ne:!1),ee=(M=U==null?void 0:U.get(y.type))==null?void 0:M.disabledText;if(y.status==="DISABLED_BY_ADMIN"&&(L=!0,ee=T.formatMessage(el.disabledByAdmin)),y.type===Me.GITHUB_CONNECTOR)return;const pe=Y.includes(y.type)&&u===I.Slurm;R.push({connected:O,disabled:L,type:"access",name:y.name,isAutoConnected:pe,element:t.jsx(Ha,{connector:y,connectorLink:(X=se.get(y.id))==null?void 0:X[0],disabled:L,disabledText:ee,hasBetaTag:(oe=U==null?void 0:U.get(y.type))==null?void 0:oe.hasBetaTag,isSelectedInSource:(k=m.has(y.type))!=null?k:!1,systemHintType:u,toggleSource:h})})}});{const y=m&&n.find(O=>O.type===Me.GITHUB_CONNECTOR),Q=a?D.find(O=>O.user_connection_details.connection_type==="github_sync_connector"):void 0;if(y||Q){const O=Q&&Q.user_connection_details.auth_status!=="not_connected"&&Q.user_connection_details.activation_status!=="inactive",te=(z=A.get(sl))==null?void 0:z[0],ge=y&&!!te;R.push({connected:!!O||!!ge,type:O?"sync":"access",name:"GitHub",element:t.jsx(yf,{clientThreadId:e,githubSyncConnection:Q,githubAccessConnector:y,connectorLink:te,selectedSources:m,toggleSource:h,systemHintType:u,refetch:W,contentRef:x})})}}const J=hf(R,p||E),[w,$]=J.reduce(([y,Q],O)=>O.connected?[[...y,O],Q]:[y,[...Q,O]],[[],[]]);return{connectedRows:w,disconnectedRows:$}},[i,r,a,m,p,E,T,h,D,v,U,W,K,V,se,b,u,Y,n,A,e,x]);if(!e||!m)return null;if(F||H||s)return t.jsx("div",{className:"w-50 px-4",children:t.jsx(tl,{lines:5,size:"lg",widthVariance:0,width:100})});const fe=Yt-ae.length,ue=ae.length>Yt;return t.jsxs("div",{className:"w-70",children:[t.jsx("div",{className:ye(ue&&"border-token-border-secondary mb-1.5 border-b","overflow-y-auto"),style:ue?{maxHeight:"calc(2.25rem * ".concat(Yt+.5,")")}:void 0,children:ae.map(({element:R,name:J})=>t.jsx(g.Fragment,{children:R},J))}),Ae.length>0&&fe>0&&t.jsx(t.Fragment,{children:Ae.slice(0,fe).map(({element:R})=>t.jsx(t.Fragment,{children:R}))}),C&&t.jsx(le.Item,{icon:dd,onSelect:()=>{_e.logEventWithStatsig("chatgpt_connectors_dropdown_connect_more_clicked","chatgpt_connectors_dropdown_connect_more_clicked"),u===I.ApiTool?bs(f,tp):N(Yo.Connectors)},children:T.formatMessage(ze.connectApps)})]})},it=({isLoading:s=!1,clientThreadId:e,enabledConnectors:n,trigger:i,includeWebSearch:r,includeCloudBrowser:a,selectedSources:c,selectedMCPSources:o,addSource:d,deleteSource:u,toggleSource:m,includeSyncConnectors:b=!1,syncConnectorFilterFn:C,connectorConfigMap:h,fetchValidLinksOnly:x,systemHintType:T,showConnectMore:S=!0})=>{const B=sa(),N=Ge(e,E=>E==null?void 0:E.startedWithMcp)===!0,f=g.useRef(null),P=g.useRef(!1);return g.useEffect(()=>{var p,A;const E=((p=c==null?void 0:c.size)!=null?p:0)+((A=o==null?void 0:o.size)!=null?A:0);!P.current&&E===0&&!N&&(d("web"),P.current=!0)},[c,o,d,N]),t.jsxs(le.Root,{"data-testid":"sources-pill",onOpenChange:E=>{var p,A;E||(rd(id(Xt(e),T))||(u(Me.GITHUB_CONNECTOR),B&&u("github_sync_connector")),((p=c==null?void 0:c.size)!=null?p:0)+((A=o==null?void 0:o.size)!=null?A:0)===0&&!N&&d("web"))},children:[i,t.jsx(le.Portal,{children:t.jsx(le.Content,{alignOffset:-7,size:"auto",ref:f,children:t.jsx(bf,{isLoading:s,clientThreadId:e,enabledConnectors:n,includeWebSearch:r,includeCloudBrowser:a,includeSyncConnectors:b,syncConnectorFilterFn:C,connectorConfigMap:h,fetchValidLinksOnly:x,systemHintType:T,selectedSources:c,selectedMCPSources:o,showConnectMore:S,toggleSource:m,contentRef:f})})})]})},lt=3,ct=s=>{"use forget";var V;const e=ts.c(42),{includeSyncConnectors:n,includeWebSearch:i,syncConnectorFilterFn:r,selectedSources:a,selectedMCPSources:c,isDeveloperMode:o}=s,d=ta();let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={productSku:Zt.PROMPT_TEXT_AREA},e[0]=u):u=e[0];const{availableConnectors:m,isLoading:b}=na(u),C=!n;let h;e[1]!==C?(h={skip:C},e[1]=C,e[2]=h):h=e[2];const{connectionInstanceData:x,isLoading:T}=mn(h),S=b||T;let B;e[3]!==i||e[4]!==a?(B=i?a!=null&&a.has("web")?t.jsx(va,{className:"icon"}):t.jsx(ld,{className:"icon"}):void 0,e[3]=i,e[4]=a,e[5]=B):B=e[5];const v=B;let N;e[6]!==a?(N=a!=null&&a.has("cloud")?t.jsx(Ra,{className:"icon"}):void 0,e[6]=a,e[7]=N):N=e[7];const f=N;let P;e[8]!==a?(P=a!=null?a:[],e[8]=a,e[9]=P):P=e[9];let E;if(e[10]!==m||e[11]!==f||e[12]!==(x==null?void 0:x.connection_statuses)||e[13]!==n||e[14]!==d||e[15]!==c||e[16]!==a||e[17]!==r||e[18]!==P||e[19]!==v){const U=[...P].filter(Af).map(R=>{const J=m.find(w=>w.type===R);return J?{name:J.name,icon:t.jsx(Bs,{connector:J,size:"xsmall"})}:null}).filter(Cf),se=n?Array.from(new Map(((V=x==null?void 0:x.connection_statuses)!=null?V:[]).filter(R=>as(R)&&(a==null?void 0:a.has(R.user_connection_details.connection_type))&&(r?r(R.user_connection_details.connection_type):!0)).map(R=>{var J;return[R.user_connection_details.connection_type,{name:yt(R),icon:t.jsx("img",{src:d&&R.connection_display_info.icon_dark_url?R.connection_display_info.icon_dark_url:(J=R.connection_display_info.icon_url)!=null?J:"",alt:R.connection_display_info.display_name,className:"icon"})}]})).values()):[],ae=Array.from(c!=null?c:[]).map(R=>{const J=m.find(w=>w.id===R);return J?{name:J.name,icon:t.jsx(Bs,{connector:J,size:"xsmall"})}:null}).filter(wf),Ae=ja([...ae,...U,...se].reverse(),kf).reverse();Ae.sort(jf);let fe;e[21]!==v?(fe=v?[{name:"web",icon:v}]:[],e[21]=v,e[22]=fe):fe=e[22];let ue;e[23]!==f?(ue=f?[{name:"cloud",icon:f}]:[],e[23]=f,e[24]=ue):ue=e[24],E=[...fe,...ue,...Ae],e[10]=m,e[11]=f,e[12]=x==null?void 0:x.connection_statuses,e[13]=n,e[14]=d,e[15]=c,e[16]=a,e[17]=r,e[18]=P,e[19]=v,e[20]=E}else E=e[20];const p=E;let A;e[25]!==p?(A=p.length>lt?[...p.slice(0,lt-1),{name:"__plus_overflow",icon:t.jsx("span",{className:"text-token-text-secondary bg-token-bg-secondary text-caption-regular flex h-4.5 w-4.5 items-center justify-center rounded-full",children:p.length-lt+1},"more")}]:p,e[25]=p,e[26]=A):A=e[26];const H=A,Y=o&&H.length>0&&"rounded-full bg-orange-400/10 hover:bg-orange-400/20";let q;e[27]!==Y?(q=ye("composer-btn px-2",Y),e[27]=Y,e[28]=q):q=e[28];let W;e[29]!==S||e[30]!==H?(W=H.length>0&&!S?t.jsx("div",{className:"flex items-center gap-1",children:H.map(Tf)}):t.jsx(cd,{className:"icon"}),e[29]=S,e[30]=H,e[31]=W):W=e[31];let F;e[32]!==o||e[33]!==S||e[34]!==H[0]||e[35]!==H.length?(F=o&&H.length>0?t.jsx("span",{className:"ms-1.5 text-orange-400 [[data-collapse-labels]_&]:sr-only",children:H.length===1?H[0].name:t.jsx(ce,{id:"+Fsfxz",defaultMessage:"Multiple Connectors"})}):(H.length<lt||S)&&t.jsx("span",{className:"ms-1.5 [[data-collapse-labels]_&]:sr-only",children:H.length===0&&!S?t.jsx(ce,{id:"UjEzZf",defaultMessage:"Add sources"}):t.jsx(ce,{id:"DhW8Wx",defaultMessage:"Sources"})}),e[32]=o,e[33]=S,e[34]=H[0],e[35]=H.length,e[36]=F):F=e[36];let D;e[37]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx(hd,{className:"icon-sm xs:ms-1.5 ms-1"}),e[37]=D):D=e[37];let K;return e[38]!==q||e[39]!==W||e[40]!==F?(K=t.jsx(le.BasicTrigger,{asChild:!0,children:t.jsxs("button",{type:"button",className:q,children:[W,F,D]})}),e[38]=q,e[39]=W,e[40]=F,e[41]=K):K=e[41],K},Ha=({connector:s,connectorLink:e,disabled:n=!1,disabledText:i="",hasBetaTag:r=!1,isSelectedInSource:a,systemHintType:c,toggleSource:o})=>{var N;const d=Ie(),u=ra(),{allAutoConnectors:m}=pn({getDisabledAutoConnectors:!1}),b=!!e,C=a&&b,h=m.includes(s.type)&&c===I.Slurm||!1;if(s.type===aa.MCP_CONNECTOR)return null;const x=(N=rl[s.type])==null?void 0:N.title,T=x?d.formatMessage(x):s.name,S=t.jsx(Bs,{connector:s,size:"xsmall"}),B=t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"truncate",children:T}),r&&t.jsx(gd,{})]}),v=h&&b?t.jsx(le.Item,{disabled:n,label:B,onSelect:()=>{window.location.href=pd(s.type)},icon:S,trailing:t.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:d.formatMessage(ze.auto)})}):b?t.jsx(le.CheckboxItem,{disabled:n,label:B,icon:S,checked:C,onCheckedChange:()=>{o(s.type)}}):t.jsx(le.Item,{disabled:n,onSelect:()=>{u({connectorId:s.id,redirectAfter:c?"/?system_hints=".concat(c):void 0,systemHintType:c,referrer:ia.SourcesDropdown})},label:B,icon:S,trailing:n?void 0:t.jsx("div",{className:"text-token-text-tertiary",children:d.formatMessage(ze.connect)})});return i=h?n?d.formatMessage(ze.autoConnectorDisabled):d.formatMessage(ze.autoConnected):i,t.jsx(t.Fragment,{children:(n||h&&b)&&i?t.jsx(un,{label:i,side:"right",align:"center",contentClassName:"w-50",children:v}):v})},Sf={box_sync_connector:"Box",dropbox_sync_connector:"Dropbox",github_sync_connector:"GitHub",gdrive_sync_connector:"Google Drive",notion_sync_connector:"Notion",slack_sync_connector:"Slack",sharepoint_sync_connector:"SharePoint",sharepoint_admin_sync_connector:"SharePoint (Admin)",linear_sync_connector:"Linear",confluence_sync_connector:"Confluence"},_f=({connector:s,connectorLinks:e,selectedMCPSources:n,toggleSource:i,systemHintType:r,disabled:a=!1})=>{var h;const c=Ie(),o=ra();if(!s.conformance.implements_retrievable&&r===I.Research)return null;const u=!!((h=e.get(s.id))==null?void 0:h[0]),m=n.has(s.id)&&u,b=s.name,C=t.jsx(Bs,{connector:s,size:"xsmall"});return t.jsx(t.Fragment,{children:u?t.jsx(le.CheckboxItem,{icon:C,checked:m,label:b,disabled:a,onCheckedChange:()=>{i(s.id)}}):t.jsx(le.Item,{onSelect:()=>{a||o({connectorId:s.id,redirectAfter:r?"/?system_hints=".concat(r):void 0,systemHintType:r,referrer:ia.SourcesDropdown})},icon:C,label:b,trailing:t.jsx("div",{className:"text-token-text-tertiary",children:c.formatMessage(ze.connect)}),disabled:a})})},Wa=({connection:s,refetch:e,location:n,isSelectedInSource:i,toggleSource:r,showDetails:a,disabled:c=!1,disabledText:o=""})=>{var K;const d=Ie(),u=ta();bt();const[m,b]=g.useState(!1),[C,h]=g.useState(),x=()=>{r(s.user_connection_details.connection_type)},T=s.user_connection_details.connection_instance_id,S=cn(),B=nl(),v=s.user_connection_details.knowledge_connector_type,N=v==="google_drive_oauth",f=g.useCallback(async()=>{try{b(!0),await ol({connectorType:v,connectionId:T,location:n,intl:d})}catch(V){V instanceof Error?S.danger(V.message,{toastId:"sources_dropdown_oauth_error"}):S.danger({defaultMessage:"Encountered an error connecting your account. Please try again later.",description:"Error message shown when a user tries to link their account but it fails."},{toastId:"sources_dropdown_oauth_error"})}finally{b(!1),e==null||e()}},[T,v,d,n,e,S]),[P,E]=g.useState(!1),p=()=>N?E(!0):f(),A=s.user_connection_details.activation_status==="inactive"&&s.user_connection_details.auth_status==="not_connected",H=["activating","partially_activated"].includes(s.user_connection_details.activation_status),Y=A&&!B||H,q=t.jsx("img",{src:u&&s.connection_display_info.icon_dark_url?s.connection_display_info.icon_dark_url:(K=s.connection_display_info.icon_url)!=null?K:"",alt:s.connection_display_info.display_name,className:"icon"}),W=V=>{if(V.stopPropagation(),V.preventDefault(),A){p();return}if(H){h(s);return}},F={key:s.connection_display_info.display_name,disabled:c,icon:q,label:yt(s),secondary:a?t.jsx("div",{className:"truncate",children:s.connection_display_info.display_name}):void 0};let D=null;switch(s.user_connection_details.activation_status){case"activated":D=t.jsx(le.CheckboxItem,os(me({},F),{checked:i,onCheckedChange:x}));break;case"partially_activated":D=t.jsx(le.CheckboxItem,os(me({},F),{checked:i,onCheckedChange:x,secondary:t.jsx("div",{className:"group-radix-disabled:opacity-50 flex items-center gap-1.5",children:t.jsx(dl,{className:"flex-row-reverse",connection:s})})}));break;case"activating":D=t.jsx(le.Item,os(me({},F),{style:{cursor:Y?void 0:"default"},onSelect:W,trailing:t.jsx("div",{className:"group-radix-disabled:opacity-50",children:t.jsx(ul,{connection:s})})}));break;case"inactive":D=t.jsx(le.Item,os(me({},F),{style:{cursor:Y?void 0:"default"},onSelect:W,trailing:t.jsx("div",{className:"group-radix-disabled:opacity-50",children:m?t.jsx(ll,{className:"icon"}):t.jsx(cl,{connection:s,refetch:e,location:"user_dropdown"})})}));break}return t.jsxs(t.Fragment,{children:[C&&t.jsx(md,{connection:C,onClose:()=>h(void 0)}),P&&t.jsx(al,{isAdminFlow:!1,onClose:()=>E(!1),connectionId:T,location:n,onSuccess:e}),c&&o?t.jsx(un,{label:o,side:"right",align:"center",contentClassName:"w-50",children:D}):D]})},yf=({clientThreadId:s,githubSyncConnection:e,githubAccessConnector:n,connectorLink:i,selectedSources:r,toggleSource:a,systemHintType:c,refetch:o,contentRef:d})=>{var E,p;const u=Ie(),m=il("installations/select_target"),b=sa(),h=Ge(s,A=>A==null?void 0:A.startedWithMcp)===!0,{data:x,isLoading:T}=fd({linkId:(E=i==null?void 0:i.id)!=null?E:""}),S=!!x,B=i==null?void 0:i.id,v=!!B&&!S;if(!n&&!e)return null;const N=A=>{const H=A==="github_sync_connector",Y=A===Me.GITHUB_CONNECTOR;if((H||Y)&&n&&e){const q=r==null?void 0:r.has("github_sync_connector"),W=r==null?void 0:r.has(Me.GITHUB_CONNECTOR);q===W&&a(H?Me.GITHUB_CONNECTOR:"github_sync_connector")}a(A)},f=n?t.jsx(Bs,{connector:n,size:"xsmall"}):e?t.jsx("img",{src:(p=e.connection_display_info.icon_url)!=null?p:"",alt:e.connection_display_info.display_name,className:"icon"}):null,P=n?n.name:e?yt(e):"";if(v&&!T)return t.jsx(le.Item,{label:P,icon:f,onSelect:()=>{window.open(m,"_blank")},trailing:t.jsx("div",{className:"text-token-text-tertiary",children:u.formatMessage(ze.finishSetup)})});if(e&&(as(e)||!n)){const A=r.has("github_sync_connector");return t.jsxs(t.Fragment,{children:[t.jsx(Wa,{connection:e,refetch:o,location:"user_dropdown",isSelectedInSource:A,toggleSource:N,showDetails:!1,disabled:T,disabledText:""},e.user_connection_details.connection_instance_id),A&&b&&t.jsx(Mo,{clientThreadId:s,allowSelectAllRepos:!1,githubSyncEnabled:!0,linkId:B,syncConnectionId:e.user_connection_details.connection_instance_id,contentRef:d})]})}else if(n){const A=r.has(Me.GITHUB_CONNECTOR);return t.jsxs(t.Fragment,{children:[t.jsx(Ha,{connector:n,connectorLink:i,disabled:h,disabledText:"",hasBetaTag:!1,isSelectedInSource:A,systemHintType:c,toggleSource:N}),A&&!0&&t.jsx(Mo,{clientThreadId:s,linkId:i==null?void 0:i.id,allowSelectAllRepos:!1,githubSyncEnabled:!1,contentRef:d})]})}return null},ze=St({contactAdmin:{id:"JGCH/x",defaultMessage:"Contact your admin to enable Google Drive for chat"},allRepositories:{id:"EzHFPp",defaultMessage:"All Repositories"},connect:{id:"OODbh3",defaultMessage:"Connect"},finishSetup:{id:"j12ad3",defaultMessage:"Finish Setup"},sourcesEnabled:{id:"aEIPI+",defaultMessage:"On"},webSearch:{id:"XoUbAe",defaultMessage:"Web search"},cloudBrowser:{id:"RA2J7e",defaultMessage:"Use cloud browser"},sourcesDisabled:{id:"j32+iI",defaultMessage:"Off"},connectApps:{id:"wwlf43",defaultMessage:"Connect more"},autoConnected:{id:"7IJBNd",defaultMessage:"This connector is searched automatically"},autoConnectorDisabled:{id:"KJQcAS",defaultMessage:"To enable this connector, toggle off all custom connectors"},auto:{id:"uW03xX",defaultMessage:"Auto"}});function Af(s){return s!=="web"&&s!=="cloud"}function Cf(s){return!!s}function wf(s){return!!s}function kf(s){return s.name}function jf(s,e){return s.name.localeCompare(e.name)}function Tf(s){return t.jsx("div",{className:"icon flex items-center justify-center",children:s.icon},s.name)}function Pf({activeSystemHint:s,clientThreadId:e,connectionStatuses:n,currentModelConfig:i}){Pe();const r=oa(),a=ht(),{availableConnectors:c,isLoading:o,enabled:d}=ml(),{availableConnectors:u,enabled:m,isLoading:b}=pl({includeDisabledByAdmin:!0,includeAutoConnectors:(s==null?void 0:s.systemHint)===I.Slurm,filterDisabledAutoConnectors:(s==null?void 0:s.systemHint)===I.Slurm}),{availableConnectors:C,enabled:h,isLoading:x}=xd({includeDisabledByAdmin:!0}),{connectorConfigMap:T}=bd({clientThreadId:e}),S=na(),B=(s==null?void 0:s.systemHint)===I.ApiTool,v=(s==null?void 0:s.systemHint)===I.Slurm&&(n&&n.length>0||m&&u.length>0),{selectedSources:N=new Set,selectedMCPSources:f=new Set,addSource:P,deleteSource:E,toggleSource:p}=Ba(e,v&&(s==null?void 0:s.systemHint)===I.Slurm),A=(s==null?void 0:s.systemHint)===I.Research,H=Na(i==null?void 0:i.id,s==null?void 0:s.systemHint);if(d&&A)return t.jsx(it,{clientThreadId:e,selectedSources:N,selectedMCPSources:f,addSource:P,deleteSource:E,toggleSource:p,isLoading:o,enabledConnectors:c,fetchValidLinksOnly:!0,systemHintType:s==null?void 0:s.systemHint,trigger:t.jsx(ct,{selectedSources:N,selectedMCPSources:f,includeSyncConnectors:!1,includeWebSearch:!0})});if(v){const Y=a!=null&&a.isPersonalAccount()?r:!0;return t.jsx(it,{clientThreadId:e,selectedSources:N,selectedMCPSources:f,addSource:P,deleteSource:E,toggleSource:p,isLoading:b,enabledConnectors:u,includeWebSearch:!1,includeSyncConnectors:Y,connectorConfigMap:T,systemHintType:s==null?void 0:s.systemHint,trigger:t.jsx(ct,{selectedSources:N,selectedMCPSources:f,includeSyncConnectors:Y,includeWebSearch:!1})})}if(B){const Y=S.availableConnectors.filter(q=>q.connector_type==="MCP");return t.jsx(it,{clientThreadId:e,selectedSources:N,selectedMCPSources:f,addSource:P,deleteSource:E,toggleSource:p,isLoading:S.isLoading,enabledConnectors:Y,includeWebSearch:!1,includeSyncConnectors:!1,connectorConfigMap:T,systemHintType:s==null?void 0:s.systemHint,trigger:t.jsx(ct,{selectedSources:N,selectedMCPSources:f,includeSyncConnectors:!1,includeWebSearch:!1,isDeveloperMode:!0})})}if(h&&H){const Y=la();return t.jsx(it,{clientThreadId:e,selectedSources:N,selectedMCPSources:f,addSource:P,deleteSource:E,toggleSource:p,isLoading:x,enabledConnectors:C,fetchValidLinksOnly:!0,systemHintType:s==null?void 0:s.systemHint,includeCloudBrowser:Y,trigger:t.jsx(ct,{selectedSources:N,selectedMCPSources:f,includeSyncConnectors:!1,includeWebSearch:!0})})}return null}const Ef=({clientThreadId:s,composerController:e,pendingFiles:n,hasFiles:i,placeholder:r,isTemporaryChat:a,state:c,inputState:o,disableReason:d,currentModelConfig:u,gizmoId:m,replyRegions:b,includeSidebarContextTray:C,onSubmit:h,leadingAction:x,legacyFooterActions:T,activeSystemHint:S,activeConnectorSystemHints:B,hideSystemHint:v=!1,isSystemHintLocked:N,onRemoveSystemHint:f,onRemoveModel:P,contextualAnswerUserConnectionData:E,fileInput:p,expanded:A,expandOnMultilineInput:H,layoutMode:Y})=>{"use forget";const q=Pe(),W=Ds(Fs),F=$o(Jo.DeveloperMode).data,D=Ge(s,Ne.getIsNewConversation),K=bt(),V=fl(),{showSelectedModelInComposer:U,showThinkingEffortPicker:se,fontSize:ae}=dn(),Ae=ca(),{composerThinkingEffort$:fe,setThinkingEffort:ue}=ua(e),R=ve(fe),J=(u==null?void 0:u.id)===da&&R&&se&&(S==null?void 0:S.systemHint)!==I.Agent&&(S==null?void 0:S.systemHint)!==I.Research,[w,$]=ve(()=>{var k;if(!u||!U&&!J)return[null];const{data:M}=Ko(q);if((M==null?void 0:M.defaultModelSlug)===u.id)return[null];const X=M==null?void 0:M.categories.find(L=>{var ee;return L.defaultModel===u.id||((ee=L.supportedModels)==null?void 0:ee.includes(u.id))});if(X)return[(k=X.actionPillShortName)!=null?k:X.label];const oe=M==null?void 0:M.groups.find(L=>L.modelIds.includes(u.id));return oe?[oe.label,u.title]:[u.title]}),z=ve(Da(e).isWhisperActive$),y=Fa(M=>M.selectedApps),Q=Oa(),O=i||Q,te=!ln(),ge=ma(e),ne=ve(()=>(te||W)&&!ge());return t.jsxs(Sd,{isTemporaryChat:a,isDeveloperMode:F,isNewConversation:D,composerController:e,expanded:A,expandOnMultilineInput:H,onSubmit:h,backgroundClassName:ye(W&&"text-sm shadow-none! dark:border-token-border-heavy border-t border-gray-100 rounded-none"),children:[t.jsx(_d,{children:z?t.jsx("div",{className:"max-w-full min-w-0 flex-1",children:t.jsx(yd,{composerController:e,className:"h-14"})}):t.jsx(Ad,{composerController:e,placeholder:r,fontSize:ae})}),p&&t.jsx(Cd,{children:p}),b&&b.length>0&&t.jsx(zt,{children:t.jsx(wd,{replyRegions:b})}),O&&t.jsx(zt,{children:t.jsx(kd,{files:n,selectedApps:y,activeSystemHintType:S==null?void 0:S.systemHint,className:"no-scrollbar horizontal-scroll-fade-mask flex flex-nowrap gap-2 overflow-x-auto px-2.5 pt-2.5 pb-1.5 [--edge-fade-distance:1rem]"})}),C&&t.jsx(zt,{children:t.jsx(jd,{})}),x&&t.jsx(Td,{children:x}),T==null?void 0:T.map((M,X)=>t.jsx(qt,{children:M},"legacy-footer-action-".concat(X))),J&&w?t.jsx(rt,{children:t.jsx(Pd,{thinkingEffort:R,onChangeThinkingEffort:M=>{ue(M),Ae.mutate({model_slug:u.id,thinking_effort:M})},modelLabel:w,modelSlug:u.id,onRemoveModel:P,onCloseAutoFocus:M=>{pa(q).composer.autofocusDisabled$()||(M.preventDefault(),Je(Se(e)))}})},"effort-selector"):U&&w?t.jsx(rt,{children:t.jsx(Ed,{label:w,tooltipLabel:$,onRemoveModel:P})},"active-model-pill"):null,en(K)&&!v&&B&&B.map(M=>t.jsx(rt,{children:t.jsx(vo,{activeSystemHint:M,locked:N,onRemoveSystemHint:()=>V(M.systemHint)})},"active-hint-tags-".concat(M.systemHint))),S&&!v&&!en(K)&&t.jsx(rt,{children:t.jsx(vo,{activeSystemHint:S,locked:N,onRemoveSystemHint:f})},"active-hint-tag"),S&&u&&t.jsxs(qt,{children:[t.jsx(Pf,{activeSystemHint:S!=null?S:void 0,clientThreadId:s,connectionStatuses:E==null?void 0:E.connection_statuses,currentModelConfig:u}),(S==null?void 0:S.systemHint)===I.Agent&&gl(q)&&t.jsx(Md,{clientThreadId:s,activeSystemHintType:S.systemHint,layoutMode:Y})]},"sources-tag"),(S==null?void 0:S.systemHint)===I.PictureV2&&t.jsx(qt,{children:t.jsx(vd,{composerController:e})},"image-style-picker"),t.jsxs(Rd,{children:[!ne&&!0&&t.jsx(Bd,{composerController:e,composerType:"composer-btn"}),!z&&t.jsx(Nd,{inputState:o,state:c,onSubmit:h,composerController:e,clientThreadId:s,gizmoId:m,disableReason:d})]})]})},Mf=an(()=>rn(()=>import("./foaloc98fvuwqvvu.js"),__vite__mapDeps([8,1,2,3,4,5,9])).then(s=>s.GithubOnboardingModal)),vf=()=>null,Rf=3e3,Bf=()=>{};function eg({onCreateNewCompletion:s,onContinueGenerating:e,account:n,currentModelId:i,currentModelConfig:r,disableDraftPersistence:a=!1,areModelsLoading:c,clientThreadId:o,isNewThread:d,isCompletionInProgress:u,disabled:m=!1,disabledReason:b,canPause:C=!1,canContinue:h=!1,isInteractableSharedThread:x,headerClassName:T,hideHeader:S,onlyAllowImageUploads:B,layoutMode:v,modelsData:N}){"use forget";var eo,so,to,no,oo,ao,ro,io;Ro.markStart("PromptTextarea"),Ro.markRendered("PromptTextarea");const f=Pe(),[P,E]=yc(),p=Wo();Dd(p),Fd();const A=nn(),H=n==null?void 0:n.isTeam(),Y=n==null?void 0:n.isEnterprisey(),q=n==null?void 0:n.isBusiness(),W=n==null?void 0:n.isEdu(),F=mt(f),D=Ie(),K=cn(),V=Vo(),U=Od.useStore(),se=Ut(l=>l.files.map(_=>_.fileId).filter(_=>_!=null)),ae=!!(H||Y||q||W),[Ae,fe,ue,R,J,w,$]=Ge(o,l=>{var _,G,ie,Ce,be;return[Ne.getCurrentLeafId(l),Ne.getRequestId(l),Ne.findNode(l,we=>{var Ve;return!!((Ve=we.message.metadata)!=null&&Ve.b1de6e2_s)}),Ne.getIsNewConversation(l),(ie=(G=(_=Ne.lastUserMessage(l))==null?void 0:_.metadata)==null?void 0:G.system_hints)==null?void 0:ie.includes(I.Agent),!!(l!=null&&l.interruptionInProgress)&&!!((be=(Ce=Ne.getCurrentNode(l))==null?void 0:Ce.message.metadata)!=null&&be.n7jupd_message),l==null?void 0:l.startedWithMcp]}),{gizmoEditorData:z,mode:y,getGizmoId:Q}=hl(),O=xl(),te=bl(),ge=Sl(),ne=Xo(o),M=!!_l(),X=Ld.useIsEnabled(o),oe=!!xt(),k=bt(),L=yl(),ee=Al(),pe=Pa(),ke=g.useCallback(()=>{pe==="show"&&bs(f,({onClose:l})=>t.jsx(Ea,{clientThreadId:o,onClose:l,source:"composer_system_hint"}))},[pe,f,o]),Ee=g.useCallback(l=>{l!==null&&(Cl(l)?ee(l,{analyticsMetadata:{clientThreadId:o}}):L(l,{analyticsMetadata:{clientThreadId:o}}),l===I.Agent&&ke())},[L,o,ke,ee]),je=Ca(),Re=ss(rs.hasSeenAgentModeAnnouncementBanner),[ls,_s]=Ds(l=>[wl(l),Fs(l)]),za=kl(f),qa=jl(f),Va=ln(),Ye=!qa&&!ls&&!Va&&Tl(f).getLayer("3081064739").get("composer-plus-menu",!1),$a=mo.useStore(),At=mo.useState(({locked:l})=>l),Ja=Pl(),fn=El(),{connectionInstanceData:gn,isLoading:Ya}=mn({skip:!Ja}),{selectedSources:cs,selectedMCPSources:Fe,addSource:Ct}=Ba(o);g.useEffect(()=>{const l=P.get("add_source");l&&k&&(Ct(l),P.delete("add_source"),E(P))},[k,Ct,P,E]);const{eligible:hn,isLoading:xn}=ss(rs.hasSeenTatertotNux);g.useEffect(()=>{k===I.Tatertot&&He(f,"1586944302")&&hn&&!xn&&bs(f,Id)},[k,hn,xn,f]);const bn=Ud(f);Ml({skip:!bn,productSku:Zt.PROMPT_TEXT_AREA});const{platformConnectors:wt}=vl(bn&&((eo=Fe==null?void 0:Fe.size)!=null?eo:0)>0,Zt.PROMPT_TEXT_AREA),{allAutoConnectors:Ka}=pn({getDisabledAutoConnectors:!1});Rl({platformConnectors:wt,enabled:Ka.length>0&&ae});const Sn=g.useMemo(()=>Array.from(Fe!=null?Fe:[]).map(l=>wt.get(l)).filter(l=>l!==void 0),[Fe,wt]),kt=g.useRef(0),jt=Ue(f,"3396794266").get("restore_prompt_on_stop",!1),Is=g.useRef(null),[de,qe,Ke,ys]=Df(o),Qa=Bl(),us=(so=qe==null?void 0:qe.gizmo.id)!=null?so:Qa,_n=Nl(us),Xa=Gd(),Tt=Hd(o),ds=po(r,de,k),As=Dl(),Za=As!=null,Us=Fl(f).flags,Gs=Us==null?void 0:Us.includes(Ol.NoAuthEnableFileUploads),{systemHints:er}=Ll(),sr=!He(f,"3084799213"),tr=R||(J!=null?J:!1)||sr,nr=!At&&(de==null||(de==null?void 0:de.kind)===pt.PrimaryAssistant||(de==null?void 0:de.kind)===pt.GizmoInteraction&&_n),Z=Ff(nr,er,r,de,te,tr),Cs=Z==null||Z.length>0,xe=g.useMemo(()=>{var l;return(l=k&&(Z==null?void 0:Z.find(_=>_.systemHint===k)))!=null?l:null},[Z,k]),ws=Il(),or=g.useMemo(()=>{var l;return(l=Z==null?void 0:Z.filter(_=>ws.has(_.systemHint)))!=null?l:[]},[Z,ws]),Pt=g.useCallback(()=>{L(null,{analyticsMetadata:{clientThreadId:o}})},[L,o]),yn=Ul(),ms=Of(N),An=ca(),Hs=g.useCallback((l,_)=>{_e.logEventWithStatsig("Model Switcher Model Changed","chatgpt_model_switcher_model_changed",{from:i,to:l}),He(f,"1333611684")?An.mutate({model_slug:l}):Gl(f,l),yn({modelId:l,location:_}),fo(o)},[i,yn,f,An,o]),Cn=g.useCallback(l=>{go()&&(l==null||l.preventDefault()),Hs(ms!=null?ms:"","remove non-default model")},[Hs,ms]),Ws=Na(i,(to=xe==null?void 0:xe.systemHint)!=null?to:null),ar=!m&&(ds!==vs.None||c)&&(F||Gs),Oe=Hl(r,de),zs=Wl(r,de),Qe=Ut(l=>y==="magic"?l.files.filter(_=>_.gizmoId!=null):l.files.filter(_=>_.gizmoId==null),ea),[Et]=g.useState(()=>Wd()),rr=zd(),wn=Qe.length>0||rr,kn=Ut(zl.hasUploadInProgress),ir=Fa(l=>l.selectedApps),lr=Oa(),cr=qd(o),ur=g.useMemo(()=>{const l=ql(p);return ft(()=>Qm(r,l()))},[r,p]),Mt=ve(ur),vt=ma(p),qs=ve(vt),jn=!qs,Vs=!Mt&&!kn&&(jn||wn),{composerThinkingEffort$:dr}=ua(p),Tn=(ds===vs.Multimodal?Vl:$l)-Qe.length,Pn=Tn<=0,mr=(xe==null?void 0:xe.systemHint)===I.Research,pr=He(f,"3544641259"),{selectedRepos:Rt}=Vd(o),En=(mr||Ws)&&pr&&(cs==null?void 0:cs.size)===0&&(Fe==null?void 0:Fe.size)===0,Mn=(no=ue==null?void 0:ue.message.metadata)==null?void 0:no.async_task_id,Xe=$d(l=>Mn?l.tasks[Mn]:null),Bt=(Xe==null?void 0:Xe.status)===Jd.RUNNING&&!Tt,vn=(ao=Yd((oo=ot(o))!=null?oo:o))==null?void 0:ao.value,fr=vn===ho.STREAMING,gr=vn===ho.REALTIME,$s=u&&C||fr||gr||Bt,Js=Vs&&!m&&!oe&&(!$s||Tt)&&!En,{targetedContent:Ys,setTargetedContent:Ks}=Kd(),re=Ys!=null&&Ys.isFocusedViewContent&&!ge?void 0:Ys,ks=pa(f);g.useEffect(()=>{!re||ks.composer.autofocusDisabled$()||requestAnimationFrame(()=>requestAnimationFrame(()=>{Je(Se(p))}))},[re,ks,p]);const{getUpsellLabelType:hr,getUpsellShowsAttach:xr}=Qd(),Rn=dn(),{isSingleLine:Ze,plusButtonAddsFiles:br,loggedOutAttachLabel:Sr,loggedOutHideToolButtons:Bn,fullyCollapsedToolMenu:_r,showSlashHint:yr,showSelectedModelInComposer:Ar,showModelsInPlusMenu:Cr}=Rn,Nt=_r&&!Ye,wr=Cr&&!Ye,kr=Cs&&F&&(!H||!Ya)&&!xo(k)&&!Ze,js=ve(Da(p).isWhisperActive$);g.useCallback(()=>{E(l=>(l.delete("share_prompt"),l))},[E]),g.useCallback(l=>{if($e(o,_=>{_.isUsingPromptTemplate=!0}),at(Se(p),l.prompt),l.system_hint){const _=l.system_hint;if(L(_),l.sources){const G=l.sources.map(be=>be.trim()).filter(Qt),ie=new Set(G.filter(be=>!gs(be))),Ce=new Set(G.filter(gs));$e(o,be=>{be.selectedSources=new Map([[_,ie]]),be.selectedMCPSources=new Map([[_,Ce]]),be.hasModifiedSources=!0})}}},[o,p,L]),Bf(f,P.get("share_prompt")),g.useEffect(()=>{if(!(A!=null&&A.id))return;const l=Bo.getAndReset(A.id,ne);l&&at(Se(p),l.inputText)},[A==null?void 0:A.id,ne,p]),g.useEffect(()=>{var _;const l=(_=P.get("prompt"))!=null?_:"";vt()&&l.length>0&&at(Se(p),l)},[vt,p,P]);const Dt=g.useCallback(()=>{k!==I.Slurm&&k!=null&&!(Z!=null&&Z.some(l=>l.systemHint===I.Slurm))||(xe==null&&L(I.Slurm),$e(o,l=>{var G,ie;const _=(ie=(G=l.selectedSources)==null?void 0:G.get(I.Slurm))!=null?ie:new Set;l.selectedSources==null&&(l.selectedSources=new Map),l.selectedSources.set(I.Slurm,new Set([..._,Me.GITHUB_CONNECTOR]))}))},[k,xe,o,L,Z]);g.useEffect(()=>{if(P.has("github_onboarding")){const l=P.get("github_onboarding");let _=Ms.ConfigureRepos;l&&[Ms.ConfigureRepos,Ms.SyncRepos,Ms.IndexRepos].includes(l)&&(_=l),fn&&_!==Ms.ConfigureRepos?Dt():bs(f,Mf,{initialState:_,onFinishFlow:Dt}),E(G=>(G.delete("github_onboarding"),G))}},[P,E,f,k,xe,o,L,Z,Dt,fn]),g.useEffect(()=>{const l=Jl(P),_=k!=null?k:l[0],G=_===I.Slurm,ie=_===I.Research;if(!G&&!ie)return;const Ce=P.getAll("sources");if(!Ce.length)return;const be=P.get("redirect_source"),we=Ce.map(he=>he.trim()).filter(Qt),Ve=new Set(we.filter(he=>!gs(he))),tt=new Set(we.filter(gs));$e(o,he=>{he.selectedSources=new Map([[_,Ve]]),he.selectedMCPSources=new Map([[_,tt]]),he.hasModifiedSources=!0}),E(he=>(he.delete("sources"),he)),be==="suggested_ca_prompts"&&_e.logEventWithStatsig("chatgpt_contextual_answers_connector_activated","chatgpt_contextual_answers_connector_activated",{source:"suggested_ca_prompts"})},[o,Ct,P,L,E,k]);const Le=Yl(r,de),Ft=ve(Kl(f,o)),{handleFileAccepted:Nn}=ip(D,po(r,de,k),Oe,"mouse",Q,Le==null?void 0:Le.attachments,Ft),jr=g.useCallback((l,_)=>(requestAnimationFrame(()=>{requestAnimationFrame(()=>{Je(Se(p))})}),Nn(l,_)),[p,Nn]),Be=!m&&!Pn&&ar&&As==null,{getInputProps:Tr,open:Dn}=ap(me({disabled:!Be,noClick:!0,onDropAccepted:jr,onDropRejected:l=>lp(l,D,K,ds),multiple:!0,maxSize:Xl,maxFiles:Tn},Ql(!F||B?Oe:zs))),es=g.useCallback(()=>{Be&&(_e.logEventWithStatsig("Open File Viewer","chatgpt_web_file_viewer_opened",{intent:ds.toString()}),Dn())},[Be,Dn,ds]),Fn=Zl(Et),On=g.useCallback(()=>{ec(Se(p)),Fn.clearMessages(),No(p).resetData();for(const _ of Qe)Es.remove(V,_.tempId,"none");if(Xd.markAllAsSent(),sc(f)){const _=zo(f,"269676899"),G=_.get("skip_search",!1);if(_.get("clear_all",!1)){const Ce=[I.Slurm,I.Tatertot,I.Think,I.ApiTool,null,G?I.Search:null,ut].filter(be=>be!=null);k&&!Ce.includes(k)&&L(null)}}},[p,Fn,f,Qe,V,k,L]),Pr=g.useMemo(()=>{if(_s)return Zd;if(ls)return em;if(la())return sm},[_s,ls]),Ln=ve(()=>_s&&za&&bo.sidebarUrlTrayOpen$());tm();const Er=tc(),In=Vt((l,_)=>{var tt;if(l.preventDefault(),m||!Vs&&!_||!de||w)return;const G=So(Se(p).state.doc),ie=G.content;Ts==="streaming"&&(_e.logEventWithStatsig("chatgpt_web_conversation_stream_interrupted","chatgpt_web_conversation_stream_interrupted",{interrupted_message_length:ie.length}),Gt.count(Ht.DEFAULT,"chatgpt_web_conversation_stream_interrupted",[])),Gt.count(Ht.DEFAULT,"chatgpt_web_conversation_completion_sent",[]);const{content:Ce,attachments:be}=nm(V,ie,r,de,k);$e(o,he=>{he.hasModifiedSources=!1,he.hasModifiedGithubRepos=!1,he.startedWithMcp===void 0&&(he.startedWithMcp=Sn.length>0)}),Xa();const we=Do.getState().attachedTempTextdocs;jt?Is.current={content:G.content,files:Qe.map(he=>me({},he)),attachedTempTextdocs:Object.fromEntries(Object.entries(we).map(([he,di])=>[he,me({},di)])),systemHintType:k!=null?k:null,selectedSources:cs?[...cs]:void 0,selectedMCPSources:Fe?[...Fe]:void 0}:Is.current=null;const Ve=i===da?nc(dr):void 0;s(me({sourceEvent:l,attachments:be,content:Ce,contentToSend:G,conversationMode:de,hasSelectedApps:lr,isMessageFollowupsEnabled:X,selectedApps:ir,desktopOrigin:Pr,shouldCollectSidebarContext:Ln,desktopSidebarContext:bo.context$(),selectedGizmoTag:Ke,selectedRepos:{selectedAllRepos:Rt.selectedAllRepos,selectedRepos:Rt.selectedRepos?[...Rt.selectedRepos]:null},selectedSources:cs,selectedMCPConnectors:Sn,startedWithMcp:$===!0,systemHints:oc($a),isN7jupdActive:Ws,isForceAllowCustomMcpModeEnabled:Er,thinkingEffort:Ve},No(p).getData(G.content))),(tt=re==null?void 0:re.onCreateCompletion)==null||tt.call(re,{serverThreadId:ne,currentLeafId:Ae}),(re==null?void 0:re.shouldPersistAcrossMessages)!==!0&&Ks(void 0),_o.hideThreadHeader();for(const he of Qe)he.status===ac.Ready&&U.addFile(he);On(),je&&k===ut&&Re.markAsViewed()}),Mr=l=>{Ks(l.targetedReply),l.targetedReply&&_e.logEventWithStatsig("Targeted Reply Button Clicked","chatgpt_targeted_reply_button_clicked",{conversationId:ne,sourceMessageId:l.messageId})},{maybeSetWaitingForRealtimeOnAbort:Un,isWatingForRealtimeStatusChange:vr}=om(o),Ot=g.useCallback((l,_="other")=>{Un(),am(l,void 0,{clientInitiated:!0,reason:_,isLastTurnAgent:J,hasAgentSystemHint:k===ut})},[Un,J,k]),Gn=g.useCallback(()=>{var l;(l=re==null?void 0:re.onCleared)==null||l.call(re,{serverThreadId:ne,currentLeafId:Ae}),Ks(void 0),Je(Se(p))},[Ae,ne,re,Ks,p]),Qs=rc(r==null?void 0:r.tags,de==null?void 0:de.kind),{autocompletions$:Rr,shouldShowAutocomplete$:Xs}=xa(p),Br=g.useCallback(()=>Xs()&&d,[Xs,d]),Hn=Vt(l=>rm(l,{toaster:K,canSubmit:Js,isTextContentTooLong:Mt,requestCompletion:In})),Wn=Vt(l=>im(l,{canAbortCompletion:C&&u,clientThreadId:o,isAutocompletionActive:Br,clearAutocompletions:()=>Rr.set([]),abortCompletion:()=>Ot(o,"escape_key"),isEmpty:qs,hasTargetedContent:re!=null,clearTargetedContent:Gn,hasSystemHint:xe!=null,removeSystemHint:Pt,hasSelectedTarget:Ke!=null,removeSelectedTarget:()=>ys(null),hasNonDefaultModel:Ar&&i!==ms,removeNonDefaultModel:Cn}));g.useEffect(()=>{if(!Js)return;He(f,"4178431533")||lm(!0).then(_=>{cm.startEnforcement(_),um.startEnforcement(_)})},[Js,f]),g.useEffect(()=>ic(Se(p),{Enter:Hn,Escape:Wn}),[p,Hn,Wn]);const Nr=l=>{Hm({filePickerStore:V,event:l.nativeEvent,intl:D,toaster:K,clientThreadId:o,conversationMode:de,currentModelConfig:r,getEditorGizmoId:Q,modelSupportedImageMimeTypes:Oe,activeSystemHintType:k,ctx:f,contextScopes:Ft})},Dr=lc(o,Et,Oe,Le==null?void 0:Le.attachments),Fr=g.useCallback((l,_)=>{l.preventDefault(),Ot(o,_),_e.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:ot(o),currentLeafId:Ne.getCurrentNode(Xt(o)).message.id,eventSource:"mouse"});const G=Is.current;jt&&G&&(at(Se(p),G.content),Es.restoreFiles(V,G.files),Do.setState({attachedTempTextdocs:G.attachedTempTextdocs}),G.systemHintType&&(L(G.systemHintType),$e(o,ie=>{var Ce,be;G.selectedSources&&(ie.selectedSources=(Ce=ie.selectedSources)!=null?Ce:new Map,ie.selectedSources.set(G.systemHintType,new Set(G.selectedSources))),G.selectedMCPSources&&(ie.selectedMCPSources=(be=ie.selectedMCPSources)!=null?be:new Map,ie.selectedMCPSources.set(G.systemHintType,new Set(G.selectedMCPSources)))})),Is.current=null),dm()},[o,Ot,p,V,L,jt]),zn=g.useCallback(()=>{Bo.set(A==null?void 0:A.id,ne,mm(p))},[ne,A==null?void 0:A.id,p]),qn=z!=null;g.useEffect(()=>{qn||ks.composer.autofocusDisabled$()||Je(Se(p))},[p,qn,ks]);const Vn=dt(Qe);g.useEffect(()=>{var _;if(Oe.length>0)for(const G of Vn.current)pm((_=G.fileSpec)==null?void 0:_.mimeType,zs)||Es.remove(V,G.tempId,"none");else Es.reset(V)},[i,V,zs,Oe.length,Vn]),g.useEffect(()=>{(!Qs&&Ke||M)&&ys(null)},[Qs,Ke,M,ys]);const Or=Ue(f,"4031588851"),$n=Ue(f,"3637408529"),Lr=$n.get("is_in_composer_text_exp",!1),Ir=$n.get("composer_text","MESSAGE_CHATGPT"),Ur=Or.get("composer_text","MESSAGE_CHATGPT"),Gr=Lr?Ir:Ur,[Zs,Hr]=(()=>{const l=b?fm(b):void 0;if(l)return[l.placeholder,l.isLastingDisabledStyle];if(x)return[Te.placeholderWithName,!1];if((re==null?void 0:re.placeholderTextOverride)!=null)return[re.placeholderTextOverride,!1];if((r==null?void 0:r.id)===cc)return[Te.n7jupdSystemHintPlaceholder,!1];if(xe){if(xo(xe.systemHint))return $s?[Te.n7jupdActivePlaceholder,!1]:[Te.n7jupdSystemHintPlaceholder,!1];switch(xe.systemHint){case I.Search:return[Te.searchPlaceholder,!1];case I.Think:return[Te.thinkPlaceholder,!1];case I.Slurm:return[Te.connectorPlaceholder,!1];case I.ApiTool:return[Te.apiToolPlaceholder,!1];case I.Research:return[Te.researchPlaceholder,!1];case I.Canvas:return[Te.canvasPlaceholder,!1];case I.Picture:return[Te.picturePlaceholder,!1];case I.PictureV2:return[Te.pictureV2Placeholder,!1];case I.Tatertot:return[Te.tatertotPlaceholder,!1]}}switch(Gr){case"BLANK":return[null,!1];case"ASK_ANYTHING":return[Te.placeholderAskAnythingVariant,!1];case"ASK_CHATGPT_ANYTHING":return[Te.placeholderAskNameAnythingVariant,!1];default:return[Te.placeholderWithName,!1]}})(),Wr=(()=>{var l,_;return _n?d?D.formatMessage(gm.newChatInProject,{projectName:(l=qe==null?void 0:qe.gizmo.display.name)!=null?l:"this project"}):Zs?D.formatMessage(Zs,{name:"ChatGPT"}):"â€‹":Zs?D.formatMessage(Zs,{name:z!=null?y==="magic"?uc:z.name||"GPT":(_=qe==null?void 0:qe.gizmo.display.name)!=null?_:"ChatGPT"}):"â€‹"})();g.useEffect(()=>yo(Ao(p),()=>{kt.current=performance.now(),Sc.getState().isThreadHeaderVisible&&_o.hideThreadHeader(),Xm(o)&&Zm(o)}));const{shouldHighlight$:zr}=hm(p),et=ve(()=>zr()),{connectorConfig:ns,isLoading:qr}=dc(),{onSelectConnector:st,onConnectorOauthRedirect:Jn}=xm({connectorConfig:ns,modelSupportedImageMimeTypes:Oe,modelAcceptedMimeTypes:zs,attachmentsProductFeature:Le==null?void 0:Le.attachments,onOauthRedirect:zn});bm(ns,st);let Yn=null;const Kn=xr(),Vr=F||Kn||Gs,{showRecentFilesDropdown:$r}=Sm(f,!0),ps=ds===vs.None&&!c?$t.ModelNotSupported:Pn?$t.HasReachedMaxFiles:As!=null?$t.RateLimitReached:void 0,Jr=t.jsx("div",{"data-testid":"composer-action-file-upload",style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:t.jsx(gf,{clientThreadId:o,modelSupportedImageMimeTypes:Oe,openFileDialog:es,historyDisabled:te,highlightTooltip:et,isLoadingConnectors:qr,connectorConfig:ns,onSelectConnector:st,onConnectorOauthRedirect:Jn,showLabel:hr()==="all"&&(mt(f)||Sr),showUpsell:Kn&&!Gs,showMenuForNoAuth:Gs,isDisabled:!Be||js,disabledReason:ps,currentModelName:(ro=r==null?void 0:r.title)!=null?ro:"",visualTreatment:F?"composer-btn":"legacy"})},"file-upload-button");g.useEffect(()=>mc(f).addAction({key:"uploadFile",action:es,actionMessageDescriptor:wa(f,D,!Be,ps,r==null?void 0:r.title),group:ym.Chat,keyboardBinding:_m}),[f,r,ps,D,Be,es]);const Yr=Ue(f,"853191128"),Kr=!F&&He(f,"3259514411")&&Yr.get("is_tatertot_enabled",!1),Qn=Oe.length>0,Lt=Ge(o,Ne.getSteeringAsyncTaskId);if(Ze&&!Lt){const _=!Ye&&Cs&&(Am(ns)||Z&&Z.length>5),G=F&&Be&&t.jsxs(le.Group,{children:[Ye&&t.jsx(Fo,{includeAction:!0,shortName:!0,connectorConfig:ns,onConnectorClick:st}),t.jsx(Wm,{includeSeparator:!1,includeAction:!0,shortName:!0,connectorConfig:ns,onConnectorClick:Jn})]},"connect-apps"),ie=[Nt&&F&&(Cs||G)?t.jsxs(zm,{layoutMode:v,children:[t.jsx(le.Group,{children:t.jsx(Jt,{systemHints:Z,activeConnectorSystemHintTypes:ws,selectedHintType:k,onSelectHintType:Ee})}),G]},"tools-menu"):null,wr?t.jsx(qm,{layoutMode:v,selectedModelId:i!=null?i:"",onSelectModelId:we=>{Hs(we,"plus menu")}},"models-menu"):null].filter(we=>we!=null),Ce=Z&&(_?Z.slice(0,4):Z),be=[t.jsxs(le.Group,{className:"content-sheet:content-sheet-inset-section",children:[t.jsx(Cm,{openFileDialog:es,modelSupportsImages:Qn,mode:Ye?"sheet":void 0,showMenuForNoAuth:!1,isDisabled:!Be,disabledReason:ps,currentModelName:r==null?void 0:r.title,rateLimitInfo:As}),F&&t.jsxs(t.Fragment,{children:[Be&&Qn&&t.jsx(wm,{modelSupportedImageMimeTypes:Oe}),!Ye&&Be&&t.jsx(Fo,{includeAction:!0,shortName:!0,connectorConfig:ns,onConnectorClick:st}),$r&&t.jsx(km,{attachedFileIds:se,onAttachLibraryFile:we=>Es.attachLibraryFile(V,we)}),t.jsx(jm,{}),t.jsx(Qp,{modelSupportedImageMimeTypes:Oe})]})]},"add-files"),(!Nt||!F)&&Cs?t.jsxs(le.Group,{children:[t.jsx(Jt,{systemHints:Ce,activeConnectorSystemHintTypes:ws,selectedHintType:k,onSelectHintType:Ee}),_&&t.jsxs(Tm,{layoutMode:v,children:[t.jsx(le.Group,{children:t.jsx(Jt,{systemHints:Z==null?void 0:Z.slice(4),activeConnectorSystemHintTypes:ws,selectedHintType:k,onSelectHintType:Ee})}),G]})]},"system-hints"):null,(!Nt||!F)&&G&&(!_||!Cs||Ye)?G:null,ie.length>0?t.jsx(le.Group,{children:ie},"submenus"):null,F?null:t.jsx(Pm,{},"upsell"),yr?t.jsx(le.Group,{children:t.jsx("div",{className:"text-token-text-tertiary p-2 text-center text-sm",children:D.formatMessage({id:"composer.plusMenu.typeSlashForQuickAccess",defaultMessage:"Type '/' for quick access"})})},"slash-hint"):null].filter(we=>we!=null);Yn=br?t.jsx(Oo,{disabled:m,clientThreadId:o,rateLimitPopup:As,highlightTooltip:et,label:F?D.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):D.formatMessage({id:"composer.plusMenu.label.loggedOut.photosOnly",defaultMessage:"Add photos"}),children:t.jsx(Em,{onClick:es,disabled:js})}):t.jsx(Mm,{mode:Ye?"sheet":"dropdown",onCloseAutoFocus:we=>{ks.composer.autofocusDisabled$()||(we.preventDefault(),Je(Se(p)))},items:be,fileUploadRateLimited:Za,children:t.jsx(Oo,{disabled:m,clientThreadId:o,rateLimitPopup:null,highlightTooltip:et,label:F?D.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):D.formatMessage({id:"composer.plusMenu.label.loggedOut",defaultMessage:"Add photos and more"}),secondaryLabel:t.jsx("kbd",{className:"bg-token-bg-tertiary -me-1 inline-grid aspect-square w-4 items-center justify-center rounded-sm text-[11px]",children:t.jsx("span",{children:"/"})}),children:t.jsx(vm,{onDoubleClick:Be?es:void 0,onPointerDown:we=>{if(!go())return;const Ve=Rm(f);Ve.isKeyboardOpen()&&(we.preventDefault(),Ve.closeKeyboard(()=>{Bm(f).open$.set(!0)}))},disabled:js})})})}const[Qr,Xn]=g.useState(!1),Xr=Hr||vr?"disabled":"default",Zr=!Js,ei=Um({promptDisabledReason:b,hasPendingFiles:kn,hasTextContent:jn,isTextContentTooLong:Mt,hasAsyncTaskPending:cr,noSourceSelectedDr:!En,isDeepResearchTaskStreaming:Bt,isThreadHardBlocked:oe}),Ts=$s?"streaming":Zr?"disabled":"idle",Ps=g.useRef(null),fs=g.useRef(null),si=He(f,"222560275")||i&&!i.startsWith("o1")&&!i.startsWith("o3");g.useEffect(()=>{const l=()=>{Ps.current!=null&&Co.addAction("composer_state_disabled",{threadId:ot(o),disabledReason:Ps.current})};if(Vs&&Ts==="disabled"){let _="unknown";m?_=b!=null?b:"component_disabled_unknown":u?_="completion_in_progress":oe&&(_="thread_hard_blocked"),Ps.current!==_&&(fs.current&&clearTimeout(fs.current),fs.current=setTimeout(l,Rf)),Ps.current=_}else Ps.current=null;return()=>{fs.current&&(clearTimeout(fs.current),fs.current=null)}},[o,Vs,Ts,m,b,u,oe]);const Zn=[re!=null&&re.label?{type:re.type,value:re.label,onRemoveRegion:Gn}:null,Ke!=null?{type:"mention",value:Ke.gizmo.display.name,icon:t.jsx(Ta,{isFirstParty:!!((io=Ke.gizmo.tags)!=null&&io.includes(Qo.FirstParty)),src:Ke.gizmo.display.profile_picture_url,className:"icon"}),onRemoveRegion:()=>{ys(null),Je(Se(p))}}:null].filter(l=>l!=null);Lt&&Xe&&Xe.taskId===Lt&&Zn.push({type:"text",value:Xe.title,onRemoveRegion:()=>fo(o)});const ti=g.useMemo(()=>ft(()=>d&&(xe==null?void 0:xe.systemHint)!==I.Research&&(xe==null?void 0:xe.systemHint)!==I.ApiTool&&!Ws&&Xs()),[d,xe,Ws,Xs]),ni=l=>{if(l.preventDefault(),l.stopPropagation(),kt.current>0){const _=performance.now()-kt.current;Gt.hist(Ht.DEFAULT,"final_user_input_to_submit_ms",[],_)}Ts==="streaming"&&(!Tt||qs)?Bt?Xn(!0):Fr(l,qs?"stop_button":"stop_button_with_prompt"):In(l)};g.useEffect(()=>{const l=ot(o),_=n==null?void 0:n.normalizedAccountUserId;if(!_||a||_s||te)return;const G=pc(ie=>{if(fc(ie.doc))gc(l);else{const Ce=So(ie.doc).content;hc(l,Ce,_)}},1e3);return yo(Ao(p),G)},[n,o,p,a,_s,te,ne]),g.useEffect(()=>{setTimeout(()=>{Co.addFirstTiming("composer.ttfi")},0)},[]);const oi=t.jsx(qp,{canUseInlineTagging:Qs,isDisabled:m,clientThreadId:o,currentLeafId:Ae,currentRequestId:fe,canContinue:h,composerController:p,isNewThread:d,onContinueGenerating:l=>{var _;return e({event:l,conversationMode:(_=Xt(o))==null?void 0:_.mode,systemHints:k?[k]:[]})},onResetState:On,openFileDialog:es,conversationMode:de}),ai=!$s&&de!=null&&si&&Nm.includes(de.kind)&&t.jsx(Dm,{clientThreadId:o,onTargetedReply:Mr}),ri=t.jsx(Vm,{composerController:p,parsedDocumentHandler:Dr}),ii=!S&&t.jsx(Rp,{className:T}),li=t.jsx(Fm,{modelSupportedImageMimeTypes:Oe,uploadType:vs.Multimodal,attachmentsProductFeature:Le==null?void 0:Le.attachments,contextScopes:Ft}),ci=He(f,"3127600850"),ui=[!Ze&&Vr?Jr:null,!F&&!Ze&&!Bn?t.jsx($m,{account:n,clientBootstrapFlags:Us,features:O,currentModelConfig:r,isDisabled:js,clientThreadId:o,composerController:p,gizmoId:us}):kr?t.jsx(Jm,{activeSystemHintType:k,systemHints:Z,composerController:p,clientThreadId:o,disabled:js}):null,!F&&!Ze&&!Bn&&Kr?t.jsx(Ym,{composerController:p,clientThreadId:o}):null].filter(l=>l!=null);return t.jsxs(Om.Provider,{value:Et,children:[t.jsxs("div",{className:ye("relative z-1 flex h-[var(--composer-container-height,100%)] max-w-full flex-[var(--composer-container-flex,1)] flex-col"),onPaste:Nr,children:[t.jsx(Lm,{onOauthRedirect:zn}),ci&&t.jsx(vf,{}),ii,Xe&&Qr&&t.jsx(Im,{taskId:Xe.taskId,clientThreadId:o,onClose:()=>Xn(!1)}),t.jsx(Ef,{hasFiles:wn,pendingFiles:Qe,isUploadDisabled:!Be,clientThreadId:o,highlightUploadTooltip:et,disableReason:ei,uploadButtonDisabledReason:ps,currentModelConfig:r,conversationMode:de,state:Ts,inputState:Xr,gizmoId:us,includeSidebarContextTray:Ln,isTemporaryChat:te,placeholder:Wr,composerController:p,onSubmit:ni,replyRegions:Zn,leadingAction:Yn,legacyFooterActions:ui,activeSystemHint:xe,activeConnectorSystemHints:or,hideSystemHint:At||!F&&!Ze,isSystemHintLocked:At,onRemoveSystemHint:Pt,onRemoveModel:Cn,contextualAnswerUserConnectionData:gn,fileInput:t.jsx("input",me({},Tr())),expanded:Ze?void 0:!0,expandOnMultilineInput:Ze,layoutMode:v}),t.jsx(of,{systemHints:Z!=null?Z:[],availableSystemHints:Z!=null?Z:[],composerController:p,clientThreadId:o,layoutMode:v,composerLayer:Rn,canUseInlineTagging:Qs,isFileUploadEnabled:Be,fileUploadDisabledReason:ps,currentModelConfig:r!=null?r:null,openFileDialog:es,connectionInstanceData:gn,setActiveSystemHintType:L,defaultModelId:ms,selectModelId:Hs,gizmoId:us!=null?us:null,hasGizmoFeatureRateLimit:M,setSelectedGizmoTag:ys}),!1,t.jsx(Gm,{canShowAutocomplete$:ti,layoutMode:v,composerController:p,clientThreadId:o})]}),ri,oi,ai,li,k&&Z&&t.jsx(Nf,{availableSystemHints:Z,systemHintType:k,onRemoveSystemHint:Pt})]})}const Nf=({availableSystemHints:s,systemHintType:e,onRemoveSystemHint:n})=>{const i=s!=null&&!en(e)&&s.every(u=>u.systemHint!==e),{externalModelsLoading:r,fullModelsLoading:a}=bc(),{isBlocked:c}=Ma(e),o=Pe(),d=!mt(o);return g.useEffect(()=>{r||a||(i||c)&&!d&&n()},[i,c,d,n,e,r,a]),null};function Df(s){"use forget";const e=ts.c(7),[n,i]=g.useState(null),r=Aa(s);let a,c;e[0]!==r||e[1]!==n?(c=n!=null?{gizmo:n,gizmo_id:n.gizmo.id,kind:pt.GizmoInteraction}:r,e[0]=r,e[1]=n,e[2]=c):c=e[2],a=c;const o=a,d=o&&"gizmo"in o&&o.gizmo!=null?o==null?void 0:o.gizmo:void 0;let u;return e[3]!==o||e[4]!==d||e[5]!==n?(u=[o,d,n,i],e[3]=o,e[4]=d,e[5]=n,e[6]=u):u=e[6],u}function Ff(s,e,n,i,r,a){"use forget";var d;const c=ts.c(7);let o;e:{if(!s){let m;c[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],c[0]=m):m=c[0],o=m;break e}let u;c[1]!==a||c[2]!==i||c[3]!==n||c[4]!==r||c[5]!==e?(u=(d=e==null?void 0:e.filter(m=>Km({systemHint:m,modelConfig:n,conversationMode:i,isTemporaryChat:r})))==null?void 0:d.filter(m=>m.systemHint!==I.Agent?!0:a),c[1]=a,c[2]=i,c[3]=n,c[4]=r,c[5]=e,c[6]=u):u=c[6],o=u}return o}function Of(s){"use forget";var e,n;return(n=(e=xc(s))==null?void 0:e.id)!=null?n:null}export{Zf as D,Xf as M,eg as P,Mp as S,Qf as T,Rp as a,mp as b,Kf as c,Yf as d,_p as u};
//# sourceMappingURL=ab6duu2lw4fd88lb.js.map
